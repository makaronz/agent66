{
  "SchemaVersion": 2,
  "CreatedAt": "2025-08-16T23:05:56.185025+02:00",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": "Cargo.lock",
      "Class": "lang-pkgs",
      "Type": "cargo",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2025-55159",
          "PkgID": "slab@0.4.10",
          "PkgName": "slab",
          "PkgIdentifier": {
            "PURL": "pkg:cargo/slab@0.4.10",
            "UID": "4566b2895b0490f8"
          },
          "InstalledVersion": "0.4.10",
          "FixedVersion": "0.4.11",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-55159",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory Rust",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Arust"
          },
          "Title": "slab: Slab: Out-of-bounds Memory Access Vulnerability",
          "Description": "slab is a pre-allocated storage for a uniform data type. In version 0.4.10, the get_disjoint_mut method incorrectly checked if indices were within the slab's capacity instead of its length, allowing access to uninitialized memory. This could lead to undefined behavior or potential crashes. This has been fixed in slab 0.4.11. A workaround for this issue involves to avoid using get_disjoint_mut with indices that might be beyond the slab's actual length.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-119"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2
          },
          "CVSS": {
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
              "V3Score": 4
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-55159",
            "https://github.com/tokio-rs/slab",
            "https://github.com/tokio-rs/slab/commit/2d65c514bc964b192bab212ddf3c1fcea4ae96b8",
            "https://github.com/tokio-rs/slab/pull/152",
            "https://github.com/tokio-rs/slab/security/advisories/GHSA-qx2v-8332-m4fv",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-55159",
            "https://rustsec.org/advisories/RUSTSEC-2025-0047.html",
            "https://www.cve.org/CVERecord?id=CVE-2025-55159"
          ],
          "PublishedDate": "2025-08-11T23:15:28.173Z",
          "LastModifiedDate": "2025-08-12T14:25:33.177Z"
        }
      ]
    },
    {
      "Target": "pnpm-lock.yaml",
      "Class": "lang-pkgs",
      "Type": "pnpm"
    },
    {
      "Target": "requirements.txt",
      "Class": "lang-pkgs",
      "Type": "pip",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2024-23334",
          "PkgName": "aiohttp",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/aiohttp@3.9.1",
            "UID": "fd31dadd43de90aa"
          },
          "InstalledVersion": "3.9.1",
          "FixedVersion": "3.9.2",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-23334",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "aiohttp: follow_symlinks directory traversal vulnerability",
          "Description": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. When using aiohttp as a web server and configuring static routes, it is necessary to specify the root path for static files. Additionally, the option 'follow_symlinks' can be used to determine whether to follow symbolic links outside the static root directory. When 'follow_symlinks' is set to True, there is no validation to check if reading a file is within the root directory. This can lead to directory traversal vulnerabilities, resulting in unauthorized access to arbitrary files on the system, even when symlinks are not present.  Disabling follow_symlinks and using a reverse proxy are encouraged mitigations.  Version 3.9.2 fixes this issue.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-22"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "nvd": 3,
            "redhat": 2,
            "ubuntu": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 5.9
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 5.9
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-23334",
            "https://github.com/aio-libs/aiohttp",
            "https://github.com/aio-libs/aiohttp/commit/1c335944d6a8b1298baf179b7c0b3069f10c514b",
            "https://github.com/aio-libs/aiohttp/pull/8079",
            "https://github.com/aio-libs/aiohttp/pull/8079/files",
            "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-5h86-8mv2-jq9f",
            "https://github.com/pypa/advisory-database/tree/main/vulns/aiohttp/PYSEC-2024-24.yaml",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ICUOCFGTB25WUT336BZ4UNYLSZOUVKBD",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ICUOCFGTB25WUT336BZ4UNYLSZOUVKBD/",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XXWVZIVAYWEBHNRIILZVB3R3SDQNNAA7",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XXWVZIVAYWEBHNRIILZVB3R3SDQNNAA7/",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-23334",
            "https://ubuntu.com/security/notices/USN-6991-1",
            "https://www.cve.org/CVERecord?id=CVE-2024-23334"
          ],
          "PublishedDate": "2024-01-29T23:15:08.563Z",
          "LastModifiedDate": "2024-11-21T08:57:32.007Z"
        },
        {
          "VulnerabilityID": "CVE-2024-30251",
          "PkgName": "aiohttp",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/aiohttp@3.9.1",
            "UID": "fd31dadd43de90aa"
          },
          "InstalledVersion": "3.9.1",
          "FixedVersion": "3.9.4",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-30251",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "aiohttp: DoS when trying to parse malformed POST requests",
          "Description": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. In affected versions an attacker can send a specially crafted POST (multipart/form-data) request. When the aiohttp server processes it, the server will enter an infinite loop and be unable to process any further requests. An attacker can stop the application from serving requests after sending a single request. This issue has been addressed in version 3.9.4. Users are advised to upgrade. Users unable to upgrade may manually apply a patch to their systems. Please see the linked GHSA for instructions.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-835"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "redhat": 3,
            "ubuntu": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "http://www.openwall.com/lists/oss-security/2024/05/02/4",
            "https://access.redhat.com/security/cve/CVE-2024-30251",
            "https://github.com/aio-libs/aiohttp",
            "https://github.com/aio-libs/aiohttp/commit/7eecdff163ccf029fbb1ddc9de4169d4aaeb6597",
            "https://github.com/aio-libs/aiohttp/commit/cebe526b9c34dc3a3da9140409db63014bc4cf19",
            "https://github.com/aio-libs/aiohttp/commit/f21c6f2ca512a026ce7f0f6c6311f62d6a638866",
            "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-5m98-qgg9-wh84",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-30251",
            "https://ubuntu.com/security/notices/USN-7642-1",
            "https://www.cve.org/CVERecord?id=CVE-2024-30251",
            "https://www.openwall.com/lists/oss-security/2024/05/02/4"
          ],
          "PublishedDate": "2024-05-02T14:15:09.627Z",
          "LastModifiedDate": "2024-11-21T09:11:32.63Z"
        },
        {
          "VulnerabilityID": "CVE-2024-23829",
          "PkgName": "aiohttp",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/aiohttp@3.9.1",
            "UID": "fd31dadd43de90aa"
          },
          "InstalledVersion": "3.9.1",
          "FixedVersion": "3.9.2",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-23829",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "python-aiohttp: http request smuggling",
          "Description": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. Security-sensitive parts of the Python HTTP parser retained minor differences in allowable character sets, that must trigger error handling to robustly match frame boundaries of proxies in order to protect against injection of additional requests. Additionally, validation could trigger exceptions that were not handled consistently with processing of other malformed input.  Being more lenient than internet standards require could, depending on deployment environment, assist in request smuggling. The unhandled exception could cause excessive resource consumption on the application server and/or its logging facilities. This vulnerability exists due to an incomplete fix for CVE-2023-47627. Version 3.9.2 fixes this vulnerability.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-444"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 2,
            "redhat": 2,
            "ubuntu": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
              "V3Score": 6.5
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
              "V3Score": 6.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
              "V3Score": 6.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-23829",
            "https://github.com/aio-libs/aiohttp",
            "https://github.com/aio-libs/aiohttp/commit/33ccdfb0a12690af5bb49bda2319ec0907fa7827",
            "https://github.com/aio-libs/aiohttp/pull/3235",
            "https://github.com/aio-libs/aiohttp/pull/8074",
            "https://github.com/aio-libs/aiohttp/pull/8074/files",
            "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-8qpw-xqxj-h4r2",
            "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-gfw2-4jvh-wgfg",
            "https://github.com/pypa/advisory-database/tree/main/vulns/aiohttp/PYSEC-2024-26.yaml",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ICUOCFGTB25WUT336BZ4UNYLSZOUVKBD",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ICUOCFGTB25WUT336BZ4UNYLSZOUVKBD/",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XXWVZIVAYWEBHNRIILZVB3R3SDQNNAA7",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XXWVZIVAYWEBHNRIILZVB3R3SDQNNAA7/",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-23829",
            "https://ubuntu.com/security/notices/USN-7642-1",
            "https://www.cve.org/CVERecord?id=CVE-2024-23829"
          ],
          "PublishedDate": "2024-01-29T23:15:08.767Z",
          "LastModifiedDate": "2024-11-21T08:58:30.683Z"
        },
        {
          "VulnerabilityID": "CVE-2024-27306",
          "PkgName": "aiohttp",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/aiohttp@3.9.1",
            "UID": "fd31dadd43de90aa"
          },
          "InstalledVersion": "3.9.1",
          "FixedVersion": "3.9.4",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-27306",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "aiohttp: XSS on index pages for static file handling",
          "Description": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. A XSS vulnerability exists on index pages for static file handling. This vulnerability is fixed in 3.9.4. We have always recommended using a reverse proxy server (e.g. nginx) for serving static files. Users following the recommendation are unaffected. Other users can disable `show_index` if unable to upgrade.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-79",
            "CWE-80"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2,
            "ubuntu": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
              "V3Score": 6.1
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
              "V3Score": 6.1
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-27306",
            "https://github.com/aio-libs/aiohttp",
            "https://github.com/aio-libs/aiohttp/commit/28335525d1eac015a7e7584137678cbb6ff19397",
            "https://github.com/aio-libs/aiohttp/commit/28335525d1eac015a7e7584137678cbb6ff19397 (v3.9.4)",
            "https://github.com/aio-libs/aiohttp/pull/8319",
            "https://github.com/aio-libs/aiohttp/pull/8319/files",
            "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-7gpw-8wmc-pm8g",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2EXRGTN2WG7VZLUZ7WOXU5GQJKCPPHKP",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2EXRGTN2WG7VZLUZ7WOXU5GQJKCPPHKP/",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NWEI6NIHZ3G7DURDZVMRK7ZEFC2BTD3U",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NWEI6NIHZ3G7DURDZVMRK7ZEFC2BTD3U/",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZIVBMPEY7WWOFMC3CWXFBRQPFECV4SW3",
            "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZIVBMPEY7WWOFMC3CWXFBRQPFECV4SW3/",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-27306",
            "https://ubuntu.com/security/notices/USN-7642-1",
            "https://www.cve.org/CVERecord?id=CVE-2024-27306"
          ],
          "PublishedDate": "2024-04-18T15:15:29.05Z",
          "LastModifiedDate": "2024-11-21T09:04:17.527Z"
        },
        {
          "VulnerabilityID": "CVE-2024-52304",
          "PkgName": "aiohttp",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/aiohttp@3.9.1",
            "UID": "fd31dadd43de90aa"
          },
          "InstalledVersion": "3.9.1",
          "FixedVersion": "3.10.11",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-52304",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "aiohttp: aiohttp vulnerable to request smuggling due to incorrect parsing of chunk extensions",
          "Description": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. Prior to version 3.10.11, the Python parser parses newlines in chunk extensions incorrectly which can lead to request smuggling vulnerabilities under certain conditions. If a pure Python version of aiohttp is installed (i.e. without the usual C extensions) or `AIOHTTP_NO_EXTENSIONS` is enabled, then an attacker may be able to execute a request smuggling attack to bypass certain firewalls or proxy protections. Version 3.10.11 fixes the issue.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-444"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 3,
            "redhat": 2,
            "ubuntu": 2
          },
          "CVSS": {
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
              "V3Score": 5.9
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-52304",
            "https://github.com/aio-libs/aiohttp",
            "https://github.com/aio-libs/aiohttp/commit/259edc369075de63e6f3a4eaade058c62af0df71",
            "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-8495-4g3g-x7pr",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-52304",
            "https://ubuntu.com/security/notices/USN-7642-1",
            "https://www.cve.org/CVERecord?id=CVE-2024-52304"
          ],
          "PublishedDate": "2024-11-18T21:15:06.5Z",
          "LastModifiedDate": "2025-08-15T17:36:18.507Z"
        },
        {
          "VulnerabilityID": "CVE-2025-53643",
          "PkgName": "aiohttp",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/aiohttp@3.9.1",
            "UID": "fd31dadd43de90aa"
          },
          "InstalledVersion": "3.9.1",
          "FixedVersion": "3.12.14",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-53643",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "aiohttp: AIOHTTP HTTP Request/Response Smuggling",
          "Description": "AIOHTTP is an asynchronous HTTP client/server framework for asyncio and Python. Prior to version 3.12.14, the Python parser is vulnerable to a request smuggling vulnerability due to not parsing trailer sections of an HTTP request. If a pure Python version of aiohttp is installed (i.e. without the usual C extensions) or AIOHTTP_NO_EXTENSIONS is enabled, then an attacker may be able to execute a request smuggling attack to bypass certain firewalls or proxy protections. Version 3.12.14 contains a patch for this issue.",
          "Severity": "LOW",
          "CweIDs": [
            "CWE-444"
          ],
          "VendorSeverity": {
            "ghsa": 1,
            "nvd": 3,
            "redhat": 1
          },
          "CVSS": {
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N",
              "V3Score": 3.7
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-53643",
            "https://github.com/aio-libs/aiohttp",
            "https://github.com/aio-libs/aiohttp/commit/e8d774f635dc6d1cd3174d0e38891da5de0e2b6a",
            "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-9548-qrrj-x5pj",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-53643",
            "https://www.cve.org/CVERecord?id=CVE-2025-53643"
          ],
          "PublishedDate": "2025-07-14T21:15:27.827Z",
          "LastModifiedDate": "2025-08-14T20:40:05.493Z"
        },
        {
          "VulnerabilityID": "CVE-2024-21503",
          "PkgName": "black",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/black@23.11.0",
            "UID": "1d7bd7865ba08794"
          },
          "InstalledVersion": "23.11.0",
          "FixedVersion": "24.3.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-21503",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "psf/black: ReDoS via the lines_with_leading_tabs_expanded() function in strings.py file",
          "Description": "Versions of the package black before 24.3.0 are vulnerable to Regular Expression Denial of Service (ReDoS) via the lines_with_leading_tabs_expanded function in the strings.py file. An attacker could exploit this vulnerability by crafting a malicious input that causes a denial of service.\r\rExploiting this vulnerability is possible when running Black on untrusted input, or if you habitually put thousands of leading tab characters in your docstrings.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333",
            "CWE-75"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-21503",
            "https://github.com/psf/black",
            "https://github.com/psf/black/commit/f00093672628d212b8965a8993cee8bedf5fe9b8",
            "https://github.com/psf/black/releases/tag/24.3.0",
            "https://github.com/pypa/advisory-database/tree/main/vulns/black/PYSEC-2024-48.yaml",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-21503",
            "https://security.snyk.io/vuln/SNYK-PYTHON-BLACK-6256273",
            "https://www.cve.org/CVERecord?id=CVE-2024-21503"
          ],
          "PublishedDate": "2024-03-19T05:15:09.447Z",
          "LastModifiedDate": "2024-11-21T08:54:34.26Z"
        },
        {
          "VulnerabilityID": "CVE-2023-50782",
          "PkgName": "cryptography",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/cryptography@41.0.8",
            "UID": "d2a8a39a5dc9a78b"
          },
          "InstalledVersion": "41.0.8",
          "FixedVersion": "42.0.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2023-50782",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "python-cryptography: Bleichenbacher timing oracle attack against RSA decryption - incomplete fix for CVE-2020-25659",
          "Description": "A flaw was found in the python-cryptography package. This issue may allow a remote attacker to decrypt captured messages in TLS servers that use RSA key exchanges, which may lead to exposure of confidential or sensitive data.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-208",
            "CWE-203"
          ],
          "VendorSeverity": {
            "azure": 3,
            "cbl-mariner": 3,
            "ghsa": 3,
            "nvd": 3,
            "photon": 3,
            "redhat": 2,
            "ubuntu": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 7.5
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2023-50782",
            "https://bugzilla.redhat.com/show_bug.cgi?id=2254432",
            "https://github.com/openssl/openssl/pull/13817",
            "https://github.com/pyca/cryptography",
            "https://github.com/pyca/cryptography/issues/9785",
            "https://nvd.nist.gov/vuln/detail/CVE-2023-50782",
            "https://people.redhat.com/~hkario/marvin/",
            "https://ubuntu.com/security/notices/USN-6663-1",
            "https://ubuntu.com/security/notices/USN-6673-1",
            "https://ubuntu.com/security/notices/USN-6673-2",
            "https://www.couchbase.com/alerts/",
            "https://www.cve.org/CVERecord?id=CVE-2023-50782"
          ],
          "PublishedDate": "2024-02-05T21:15:11.183Z",
          "LastModifiedDate": "2024-11-21T08:37:18.337Z"
        },
        {
          "VulnerabilityID": "CVE-2024-26130",
          "PkgName": "cryptography",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/cryptography@41.0.8",
            "UID": "d2a8a39a5dc9a78b"
          },
          "InstalledVersion": "41.0.8",
          "FixedVersion": "42.0.4",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-26130",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "python-cryptography: NULL pointer dereference with pkcs12.serialize_key_and_certificates when called with a non-matching certificate and private key and an hmac_hash override",
          "Description": "cryptography is a package designed to expose cryptographic primitives and recipes to Python developers. Starting in version 38.0.0 and prior to version 42.0.4, if `pkcs12.serialize_key_and_certificates` is called with both a certificate whose public key did not match the provided private key and an `encryption_algorithm` with `hmac_hash` set (via `PrivateFormat.PKCS12.encryption_builder().hmac_hash(...)`, then a NULL pointer dereference would occur, crashing the Python process. This has been resolved in version 42.0.4, the first version in which a `ValueError` is properly raised.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-476"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "nvd": 3,
            "oracle-oval": 3,
            "photon": 3,
            "redhat": 3,
            "ubuntu": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-26130",
            "https://github.com/pyca/cryptography",
            "https://github.com/pyca/cryptography/commit/97d231672763cdb5959a3b191e692a362f1b9e55",
            "https://github.com/pyca/cryptography/pull/10423",
            "https://github.com/pyca/cryptography/security/advisories/GHSA-6vqw-3v5j-54x4",
            "https://github.com/pypa/advisory-database/tree/main/vulns/cryptography/PYSEC-2024-225.yaml",
            "https://linux.oracle.com/cve/CVE-2024-26130.html",
            "https://linux.oracle.com/errata/ELSA-2025-20364.html",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-26130",
            "https://ubuntu.com/security/notices/USN-6673-1",
            "https://ubuntu.com/security/notices/USN-6673-3",
            "https://www.cve.org/CVERecord?id=CVE-2024-26130"
          ],
          "PublishedDate": "2024-02-21T17:15:09.863Z",
          "LastModifiedDate": "2025-02-05T22:09:20.427Z"
        },
        {
          "VulnerabilityID": "CVE-2024-0727",
          "PkgName": "cryptography",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/cryptography@41.0.8",
            "UID": "d2a8a39a5dc9a78b"
          },
          "InstalledVersion": "41.0.8",
          "FixedVersion": "42.0.2",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-0727",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "openssl: denial of service via null dereference",
          "Description": "Issue summary: Processing a maliciously formatted PKCS12 file may lead OpenSSL\nto crash leading to a potential Denial of Service attack\n\nImpact summary: Applications loading files in the PKCS12 format from untrusted\nsources might terminate abruptly.\n\nA file in PKCS12 format can contain certificates and keys and may come from an\nuntrusted source. The PKCS12 specification allows certain fields to be NULL, but\nOpenSSL does not correctly check for this case. This can lead to a NULL pointer\ndereference that results in OpenSSL crashing. If an application processes PKCS12\nfiles from an untrusted source using the OpenSSL APIs then that application will\nbe vulnerable to this issue.\n\nOpenSSL APIs that are vulnerable to this are: PKCS12_parse(),\nPKCS12_unpack_p7data(), PKCS12_unpack_p7encdata(), PKCS12_unpack_authsafes()\nand PKCS12_newpass().\n\nWe have also fixed a similar issue in SMIME_write_PKCS7(). However since this\nfunction is related to writing data we do not consider it security significant.\n\nThe FIPS modules in 3.2, 3.1 and 3.0 are not affected by this issue.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-476"
          ],
          "VendorSeverity": {
            "alma": 2,
            "amazon": 2,
            "azure": 2,
            "cbl-mariner": 2,
            "ghsa": 2,
            "nvd": 2,
            "oracle-oval": 2,
            "photon": 2,
            "redhat": 1,
            "ubuntu": 1
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
              "V3Score": 5.5
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
              "V3Score": 5.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
              "V3Score": 5.5
            }
          },
          "References": [
            "http://www.openwall.com/lists/oss-security/2024/03/11/1",
            "https://access.redhat.com/errata/RHSA-2024:9088",
            "https://access.redhat.com/security/cve/CVE-2024-0727",
            "https://bugzilla.redhat.com/2257571",
            "https://bugzilla.redhat.com/2258502",
            "https://bugzilla.redhat.com/2259944",
            "https://bugzilla.redhat.com/2284243",
            "https://errata.almalinux.org/9/ALSA-2024-9088.html",
            "https://github.com/alexcrichton/openssl-src-rs/commit/add20f73b6b42be7451af2e1044d4e0e778992b2",
            "https://github.com/github/advisory-database/pull/3472",
            "https://github.com/openssl/openssl/commit/09df4395b5071217b76dc7d3d2e630eb8c5a79c2",
            "https://github.com/openssl/openssl/commit/775acfdbd0c6af9ac855f34969cdab0c0c90844a",
            "https://github.com/openssl/openssl/commit/d135eeab8a5dbf72b3da5240bab9ddb7678dbd2c",
            "https://github.com/openssl/openssl/pull/23362",
            "https://github.com/pyca/cryptography/commit/3519591d255d4506fbcd0d04037d45271903c64d",
            "https://github.openssl.org/openssl/extended-releases/commit/03b3941d60c4bce58fab69a0c22377ab439bc0e8",
            "https://github.openssl.org/openssl/extended-releases/commit/aebaa5883e31122b404e450732dc833dc9dee539",
            "https://linux.oracle.com/cve/CVE-2024-0727.html",
            "https://linux.oracle.com/errata/ELSA-2024-9088.html",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-0727",
            "https://security.netapp.com/advisory/ntap-20240208-0006",
            "https://security.netapp.com/advisory/ntap-20240208-0006/",
            "https://ubuntu.com/security/notices/USN-6622-1",
            "https://ubuntu.com/security/notices/USN-6632-1",
            "https://ubuntu.com/security/notices/USN-6709-1",
            "https://ubuntu.com/security/notices/USN-7018-1",
            "https://www.cve.org/CVERecord?id=CVE-2024-0727",
            "https://www.openssl.org/news/secadv/20240125.txt"
          ],
          "PublishedDate": "2024-01-26T09:15:07.637Z",
          "LastModifiedDate": "2025-05-29T16:15:31.96Z"
        },
        {
          "VulnerabilityID": "GHSA-h4gh-qq45-vh27",
          "PkgName": "cryptography",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/cryptography@41.0.8",
            "UID": "d2a8a39a5dc9a78b"
          },
          "InstalledVersion": "41.0.8",
          "FixedVersion": "43.0.1",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://github.com/advisories/GHSA-h4gh-qq45-vh27",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "pyca/cryptography has a vulnerable OpenSSL included in cryptography wheels",
          "Description": "pyca/cryptography's wheels include a statically linked copy of OpenSSL. The versions of OpenSSL included in cryptography 37.0.0-43.0.0 are vulnerable to a security issue. More details about the vulnerability itself can be found in https://openssl-library.org/news/secadv/20240903.txt.\n\nIf you are building cryptography source (\"sdist\") then you are responsible for upgrading your copy of OpenSSL. Only users installing from wheels built by the cryptography project (i.e., those distributed on PyPI) need to update their cryptography versions.\n",
          "Severity": "MEDIUM",
          "VendorSeverity": {
            "ghsa": 2
          },
          "References": [
            "https://github.com/pyca/cryptography",
            "https://github.com/pyca/cryptography/security/advisories/GHSA-h4gh-qq45-vh27",
            "https://openssl-library.org/news/secadv/20240903.txt"
          ],
          "PublishedDate": "2024-09-03T21:59:48Z",
          "LastModifiedDate": "2024-09-03T21:59:48Z"
        },
        {
          "VulnerabilityID": "CVE-2024-33663",
          "PkgName": "python-jose",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/python-jose@3.3.0",
            "UID": "2e26324916f0e3ad"
          },
          "InstalledVersion": "3.3.0",
          "FixedVersion": "3.4.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-33663",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "python-jose: algorithm confusion with OpenSSH ECDSA keys and other key formats",
          "Description": "python-jose through 3.3.0 has algorithm confusion with OpenSSH ECDSA keys and other key formats. This is similar to CVE-2022-29217.",
          "Severity": "CRITICAL",
          "CweIDs": [
            "CWE-327"
          ],
          "VendorSeverity": {
            "ghsa": 4,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
              "V3Score": 7.4
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-33663",
            "https://github.com/mpdavis/python-jose",
            "https://github.com/mpdavis/python-jose/issues/346",
            "https://github.com/pypa/advisory-database/tree/main/vulns/python-jose/PYSEC-2024-232.yaml",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-33663",
            "https://www.cve.org/CVERecord?id=CVE-2024-33663",
            "https://www.vicarius.io/vsociety/posts/algorithm-confusion-in-python-jose-cve-2024-33663"
          ],
          "PublishedDate": "2024-04-26T00:15:09.01Z",
          "LastModifiedDate": "2024-11-21T09:17:21.073Z"
        },
        {
          "VulnerabilityID": "CVE-2024-33664",
          "PkgName": "python-jose",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/python-jose@3.3.0",
            "UID": "2e26324916f0e3ad"
          },
          "InstalledVersion": "3.3.0",
          "FixedVersion": "3.4.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-33664",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "python-jose: allows attackers to cause a denial of service",
          "Description": "python-jose through 3.3.0 allows attackers to cause a denial of service (resource consumption) during a decode via a crafted JSON Web Encryption (JWE) token with a high compression ratio, aka a \"JWT bomb.\" This is similar to CVE-2024-21319.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-400"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-33664",
            "https://github.com/mpdavis/python-jose",
            "https://github.com/mpdavis/python-jose/issues/344",
            "https://github.com/mpdavis/python-jose/pull/345",
            "https://github.com/mpdavis/python-jose/releases/tag/3.4.0",
            "https://github.com/pypa/advisory-database/tree/main/vulns/python-jose/PYSEC-2024-233.yaml",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-33664",
            "https://www.cve.org/CVERecord?id=CVE-2024-33664",
            "https://www.vicarius.io/vsociety/posts/jwt-bomb-in-python-jose-cve-2024-33664"
          ],
          "PublishedDate": "2024-04-26T00:15:09.06Z",
          "LastModifiedDate": "2024-11-21T09:17:21.297Z"
        },
        {
          "VulnerabilityID": "CVE-2024-24762",
          "PkgName": "python-multipart",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/python-multipart@0.0.6",
            "UID": "e8a0f5c9907b72b1"
          },
          "InstalledVersion": "0.0.6",
          "FixedVersion": "0.0.7",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-24762",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "`python-multipart` is a streaming multipart parser for Python. When us ...",
          "Description": "`python-multipart` is a streaming multipart parser for Python. When using form data, `python-multipart` uses a Regular Expression to parse the HTTP `Content-Type` header, including options. An attacker could send a custom-made `Content-Type` option that is very difficult for the RegEx to process, consuming CPU resources and stalling indefinitely (minutes or more) while holding the main event loop. This means that process can't handle any more requests, leading to regular expression denial of service. This vulnerability has been patched in version 0.0.7.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-400",
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "nvd": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://github.com/Kludex/python-multipart",
            "https://github.com/Kludex/python-multipart/commit/20f0ef6b4e4caf7d69a667c54dff57fe467109a4",
            "https://github.com/Kludex/python-multipart/security/advisories/GHSA-2jv5-9r88-3w3p",
            "https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74",
            "https://github.com/encode/starlette/commit/13e5c26a27f4903924624736abd6131b2da80cc5",
            "https://github.com/encode/starlette/security/advisories/GHSA-93gm-qmq6-w238",
            "https://github.com/github/advisory-database/pull/4829",
            "https://github.com/pypa/advisory-database/tree/main/vulns/fastapi/PYSEC-2024-38.yaml",
            "https://github.com/tiangolo/fastapi/commit/9d34ad0ee8a0dfbbcce06f76c2d5d851085024fc",
            "https://github.com/tiangolo/fastapi/releases/tag/0.109.1",
            "https://github.com/tiangolo/fastapi/security/advisories/GHSA-qf9m-vfgh-m389",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-24762"
          ],
          "PublishedDate": "2024-02-05T15:15:09.26Z",
          "LastModifiedDate": "2025-05-05T14:14:26.363Z"
        },
        {
          "VulnerabilityID": "CVE-2024-53981",
          "PkgName": "python-multipart",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/python-multipart@0.0.6",
            "UID": "e8a0f5c9907b72b1"
          },
          "InstalledVersion": "0.0.6",
          "FixedVersion": "0.0.18",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-53981",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "python-multipart: python-multipart has a DoS via deformation `multipart/form-data` boundary",
          "Description": "python-multipart is a streaming multipart parser for Python. When parsing form data, python-multipart skips line breaks (CR \\r or LF \\n) in front of the first boundary and any tailing bytes after the last boundary. This happens one byte at a time and emits a log event each time, which may cause excessive logging for certain inputs. An attacker could abuse this by sending a malicious request with lots of data before the first or after the last boundary, causing high CPU load and stalling the processing thread for a significant amount of time. In case of ASGI application, this could stall the event loop and prevent other requests from being processed, resulting in a denial of service (DoS). This vulnerability is fixed in 0.0.18.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-770"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "redhat": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-53981",
            "https://github.com/Kludex/python-multipart",
            "https://github.com/Kludex/python-multipart/commit/c4fe4d3cebc08c660e57dd709af1ffa7059b3177",
            "https://github.com/Kludex/python-multipart/security/advisories/GHSA-59g5-xgcq-4qw3",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-53981",
            "https://www.cve.org/CVERecord?id=CVE-2024-53981"
          ],
          "PublishedDate": "2024-12-02T16:15:14.457Z",
          "LastModifiedDate": "2024-12-02T16:15:14.457Z"
        },
        {
          "VulnerabilityID": "CVE-2024-5206",
          "PkgName": "scikit-learn",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/scikit-learn@1.3.2",
            "UID": "c2149394e12bb7a5"
          },
          "InstalledVersion": "1.3.2",
          "FixedVersion": "1.5.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-5206",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "scikit-learn: Possible sensitive data leak",
          "Description": "A sensitive data leakage vulnerability was identified in scikit-learn's TfidfVectorizer, specifically in versions up to and including 1.4.1.post1, which was fixed in version 1.5.0. The vulnerability arises from the unexpected storage of all tokens present in the training data within the `stop_words_` attribute, rather than only storing the subset of tokens required for the TF-IDF technique to function. This behavior leads to the potential leakage of sensitive information, as the `stop_words_` attribute could contain tokens that were meant to be discarded and not stored, such as passwords or keys. The impact of this vulnerability varies based on the nature of the data being processed by the vectorizer.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-921",
            "CWE-922"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 2,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 5.3
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 4.7
            },
            "redhat": {
              "V3Vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-5206",
            "https://github.com/pypa/advisory-database/tree/main/vulns/scikit-learn/PYSEC-2024-110.yaml",
            "https://github.com/scikit-learn/scikit-learn",
            "https://github.com/scikit-learn/scikit-learn/commit/70ca21f106b603b611da73012c9ade7cd8e438b8",
            "https://huntr.com/bounties/14bc0917-a85b-4106-a170-d09d5191517c",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-5206",
            "https://www.cve.org/CVERecord?id=CVE-2024-5206"
          ],
          "PublishedDate": "2024-06-06T19:16:06.363Z",
          "LastModifiedDate": "2024-11-21T09:47:11.143Z"
        },
        {
          "VulnerabilityID": "CVE-2025-32434",
          "PkgName": "torch",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/torch@2.1.2",
            "UID": "99fa6a9b0e9b339c"
          },
          "InstalledVersion": "2.1.2",
          "FixedVersion": "2.6.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-32434",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "PyTorch is a Python package that provides tensor computation with stro ...",
          "Description": "PyTorch is a Python package that provides tensor computation with strong GPU acceleration and deep neural networks built on a tape-based autograd system. In version 2.5.1 and prior, a Remote Command Execution (RCE) vulnerability exists in PyTorch when loading a model using torch.load with weights_only=True. This issue has been patched in version 2.6.0.",
          "Severity": "CRITICAL",
          "CweIDs": [
            "CWE-502"
          ],
          "VendorSeverity": {
            "azure": 4,
            "bitnami": 4,
            "cbl-mariner": 4,
            "ghsa": 4,
            "nvd": 4
          },
          "CVSS": {
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "V3Score": 9.8
            }
          },
          "References": [
            "https://github.com/pypa/advisory-database/tree/main/vulns/torch/PYSEC-2025-41.yaml",
            "https://github.com/pytorch/pytorch",
            "https://github.com/pytorch/pytorch/commit/8d4b8a920a2172523deb95bf20e8e52d50649c04",
            "https://github.com/pytorch/pytorch/security/advisories/GHSA-53q9-r3pm-6pq6",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-32434"
          ],
          "PublishedDate": "2025-04-18T16:15:23.183Z",
          "LastModifiedDate": "2025-05-28T13:14:20.75Z"
        },
        {
          "VulnerabilityID": "CVE-2024-31580",
          "PkgName": "torch",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/torch@2.1.2",
            "UID": "99fa6a9b0e9b339c"
          },
          "InstalledVersion": "2.1.2",
          "FixedVersion": "2.2.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-31580",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "PyTorch before v2.2.0 was discovered to contain a heap buffer overflow ...",
          "Description": "PyTorch before v2.2.0 was discovered to contain a heap buffer overflow vulnerability in the component /runtime/vararg_functions.cpp. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted input.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-122"
          ],
          "VendorSeverity": {
            "bitnami": 2,
            "cbl-mariner": 2,
            "ghsa": 3
          },
          "CVSS": {
            "bitnami": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 4
            },
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://gist.github.com/1047524396/038c78f2f007345e6f497698ace2aa3d",
            "https://github.com/pypa/advisory-database/tree/main/vulns/torch/PYSEC-2024-252.yaml",
            "https://github.com/pytorch/pytorch",
            "https://github.com/pytorch/pytorch/commit/b5c3a17c2c207ebefcb85043f0cf94be9b2fef81",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-31580",
            "https://security.snyk.io/vuln/SNYK-PYTHON-TORCH-6649934"
          ],
          "PublishedDate": "2024-04-17T19:15:07.783Z",
          "LastModifiedDate": "2025-06-10T17:38:16.883Z"
        },
        {
          "VulnerabilityID": "CVE-2024-31583",
          "PkgName": "torch",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/torch@2.1.2",
            "UID": "99fa6a9b0e9b339c"
          },
          "InstalledVersion": "2.1.2",
          "FixedVersion": "2.2.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-31583",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "Pytorch before version v2.2.0 was discovered to contain a use-after-fr ...",
          "Description": "Pytorch before version v2.2.0 was discovered to contain a use-after-free vulnerability in torch/csrc/jit/mobile/interpreter.cpp.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-416"
          ],
          "VendorSeverity": {
            "bitnami": 3,
            "cbl-mariner": 3,
            "ghsa": 3
          },
          "CVSS": {
            "bitnami": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 7.8
            },
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 7.8
            }
          },
          "References": [
            "https://gist.github.com/1047524396/43e19a41f2b36503a4a228c32cdbc176",
            "https://github.com/pypa/advisory-database/tree/main/vulns/torch/PYSEC-2024-251.yaml",
            "https://github.com/pytorch/pytorch",
            "https://github.com/pytorch/pytorch/blob/v2.1.2/torch/csrc/jit/mobile/interpreter.cpp#L132",
            "https://github.com/pytorch/pytorch/commit/9c7071b0e324f9fb68ab881283d6b8d388a4bcd2",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-31583",
            "https://security.snyk.io/vuln/SNYK-PYTHON-TORCH-6619806"
          ],
          "PublishedDate": "2024-04-17T19:15:07.95Z",
          "LastModifiedDate": "2025-06-10T01:33:43.18Z"
        },
        {
          "VulnerabilityID": "CVE-2025-3730",
          "PkgName": "torch",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/torch@2.1.2",
            "UID": "99fa6a9b0e9b339c"
          },
          "InstalledVersion": "2.1.2",
          "Status": "affected",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-3730",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "A vulnerability, which was classified as problematic, was found in PyT ...",
          "Description": "A vulnerability, which was classified as problematic, was found in PyTorch 2.6.0. Affected is the function torch.nn.functional.ctc_loss of the file aten/src/ATen/native/LossCTC.cpp. The manipulation leads to denial of service. An attack has to be approached locally. The exploit has been disclosed to the public and may be used. The real existence of this vulnerability is still doubted at the moment. The name of the patch is 46fc5d8e360127361211cb237d5f9eef0223e567. It is recommended to apply a patch to fix this issue. The security policy of the project warns to use unknown models which might establish malicious effects.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-404"
          ],
          "VendorSeverity": {
            "azure": 2,
            "cbl-mariner": 2,
            "ghsa": 2,
            "nvd": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 3.3
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 5.5
            }
          },
          "References": [
            "https://github.com/pytorch/pytorch",
            "https://github.com/pytorch/pytorch/commit/01f226bfb8f2c343f5c614a6bbf685d91160f3af",
            "https://github.com/pytorch/pytorch/issues/150835",
            "https://github.com/pytorch/pytorch/issues/150835#issue-2979082232",
            "https://github.com/pytorch/pytorch/pull/150981",
            "https://github.com/timocafe/tewart-pytorch/commit/46fc5d8e360127361211cb237d5f9eef0223e567",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-3730",
            "https://vuldb.com/?ctiid.305076",
            "https://vuldb.com/?id.305076",
            "https://vuldb.com/?submit.553645"
          ],
          "PublishedDate": "2025-04-16T21:15:48.7Z",
          "LastModifiedDate": "2025-05-28T17:35:54.08Z"
        },
        {
          "VulnerabilityID": "CVE-2025-2953",
          "PkgName": "torch",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/torch@2.1.2",
            "UID": "99fa6a9b0e9b339c"
          },
          "InstalledVersion": "2.1.2",
          "FixedVersion": "2.7.1-rc1",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-2953",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "torch: PyTorch torch.mkldnn_max_pool2d denial of service",
          "Description": "A vulnerability, which was classified as problematic, has been found in PyTorch 2.6.0+cu124. Affected by this issue is the function torch.mkldnn_max_pool2d. The manipulation leads to denial of service. An attack has to be approached locally. The exploit has been disclosed to the public and may be used. The real existence of this vulnerability is still doubted at the moment. The security policy of the project warns to use unknown models which might establish malicious effects.",
          "Severity": "LOW",
          "CweIDs": [
            "CWE-404"
          ],
          "VendorSeverity": {
            "azure": 2,
            "cbl-mariner": 2,
            "ghsa": 1,
            "nvd": 2,
            "redhat": 1
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 3.3
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 5.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 3.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-2953",
            "https://github.com/pytorch/pytorch",
            "https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models",
            "https://github.com/pytorch/pytorch/issues/149274",
            "https://github.com/pytorch/pytorch/issues/149274#issue-2923122269",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-2953",
            "https://vuldb.com/?ctiid.302006",
            "https://vuldb.com/?id.302006",
            "https://vuldb.com/?submit.521279",
            "https://www.cve.org/CVERecord?id=CVE-2025-2953"
          ],
          "PublishedDate": "2025-03-30T16:15:14.38Z",
          "LastModifiedDate": "2025-04-22T12:15:16.043Z"
        },
        {
          "VulnerabilityID": "CVE-2024-11392",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.48.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-11392",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Hugging Face Transformers MobileViTV2 Deserialization of Untrusted Data Remote Code Execution Vulnerability",
          "Description": "Hugging Face Transformers MobileViTV2 Deserialization of Untrusted Data Remote Code Execution Vulnerability. This vulnerability allows remote attackers to execute arbitrary code on affected installations of Hugging Face Transformers. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file.\n\nThe specific flaw exists within the handling of configuration files. The issue results from the lack of proper validation of user-supplied data, which can result in deserialization of untrusted data. An attacker can leverage this vulnerability to execute code in the context of the current user. Was ZDI-CAN-24322.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-502"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "nvd": 3,
            "redhat": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 7.5
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 8.8
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-11392",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/issues/34840",
            "https://github.com/huggingface/transformers/pull/35296",
            "https://github.com/pypa/advisory-database/tree/main/vulns/transformers/PYSEC-2024-227.yaml",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-11392",
            "https://www.cve.org/CVERecord?id=CVE-2024-11392",
            "https://www.zerodayinitiative.com/advisories/ZDI-24-1513",
            "https://www.zerodayinitiative.com/advisories/ZDI-24-1513/"
          ],
          "PublishedDate": "2024-11-22T22:15:06.97Z",
          "LastModifiedDate": "2025-02-10T22:18:55.153Z"
        },
        {
          "VulnerabilityID": "CVE-2024-11393",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.48.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-11393",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Hugging Face Transformers MaskFormer Model Deserialization of Untrusted Data Remote Code Execution Vulnerability",
          "Description": "Hugging Face Transformers MaskFormer Model Deserialization of Untrusted Data Remote Code Execution Vulnerability. This vulnerability allows remote attackers to execute arbitrary code on affected installations of Hugging Face Transformers. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file.\n\nThe specific flaw exists within the parsing of model files. The issue results from the lack of proper validation of user-supplied data, which can result in deserialization of untrusted data. An attacker can leverage this vulnerability to execute code in the context of the current user. Was ZDI-CAN-25191.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-502"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "nvd": 3,
            "redhat": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 8.8
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 8.8
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 8.8
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-11393",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/issues/34840",
            "https://github.com/huggingface/transformers/pull/35296",
            "https://github.com/pypa/advisory-database/tree/main/vulns/transformers/PYSEC-2024-228.yaml",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-11393",
            "https://www.cve.org/CVERecord?id=CVE-2024-11393",
            "https://www.zerodayinitiative.com/advisories/ZDI-24-1514",
            "https://www.zerodayinitiative.com/advisories/ZDI-24-1514/"
          ],
          "PublishedDate": "2024-11-22T22:15:07.1Z",
          "LastModifiedDate": "2025-02-10T22:18:52.253Z"
        },
        {
          "VulnerabilityID": "CVE-2024-11394",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.48.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-11394",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Hugging Face Transformers Trax Model Deserialization of Untrusted Data Remote Code Execution Vulnerability",
          "Description": "Hugging Face Transformers Trax Model Deserialization of Untrusted Data Remote Code Execution Vulnerability. This vulnerability allows remote attackers to execute arbitrary code on affected installations of Hugging Face Transformers. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file.\n\nThe specific flaw exists within the handling of model files. The issue results from the lack of proper validation of user-supplied data, which can result in deserialization of untrusted data. An attacker can leverage this vulnerability to execute code in the context of the current user. Was ZDI-CAN-25012.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-502"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "nvd": 3,
            "redhat": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 8.8
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 8.8
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "V3Score": 8.8
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-11394",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/issues/34840",
            "https://github.com/huggingface/transformers/pull/35296",
            "https://github.com/pypa/advisory-database/tree/main/vulns/transformers/PYSEC-2024-229.yaml",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-11394",
            "https://www.cve.org/CVERecord?id=CVE-2024-11394",
            "https://www.zerodayinitiative.com/advisories/ZDI-24-1515",
            "https://www.zerodayinitiative.com/advisories/ZDI-24-1515/"
          ],
          "PublishedDate": "2024-11-22T22:15:07.223Z",
          "LastModifiedDate": "2025-02-10T22:16:16.163Z"
        },
        {
          "VulnerabilityID": "CVE-2024-12720",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.48.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-12720",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "Transformers Regular Expression Denial of Service (ReDoS) vulnerability",
          "Description": "A Regular Expression Denial of Service (ReDoS) vulnerability was identified in the huggingface/transformers library, specifically in the file tokenization_nougat_fast.py. The vulnerability occurs in the post_process_single() function, where a regular expression processes specially crafted input. The issue stems from the regex exhibiting exponential time complexity under certain conditions, leading to excessive backtracking. This can result in significantly high CPU usage and potential application downtime, effectively creating a Denial of Service (DoS) scenario. The affected version is v4.46.3 (latest).",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/commit/deac971c469bcbb182c2e52da0b82fb3bf54cccf",
            "https://huntr.com/bounties/4bed1214-7835-4252-a853-22bbad891f98",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-12720"
          ],
          "PublishedDate": "2025-03-20T10:15:29.507Z",
          "LastModifiedDate": "2025-08-01T21:11:26.963Z"
        },
        {
          "VulnerabilityID": "CVE-2025-1194",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.50.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-1194",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "Transformers Regular Expression Denial of Service (ReDoS) vulnerability",
          "Description": "A Regular Expression Denial of Service (ReDoS) vulnerability was identified in the huggingface/transformers library, specifically in the file `tokenization_gpt_neox_japanese.py` of the GPT-NeoX-Japanese model. The vulnerability occurs in the SubWordJapaneseTokenizer class, where regular expressions process specially crafted inputs. The issue stems from a regex exhibiting exponential complexity under certain conditions, leading to excessive backtracking. This can result in high CPU usage and potential application downtime, effectively creating a Denial of Service (DoS) scenario. The affected version is v4.48.1 (latest).",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L",
              "V3Score": 4.3
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
              "V3Score": 6.5
            }
          },
          "References": [
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/commit/92c5ca9dd70de3ade2af2eb835c96215cc50e815",
            "https://huntr.com/bounties/86f58dcd-683f-4adc-a735-849f51e9abb2",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-1194"
          ],
          "PublishedDate": "2025-04-29T12:15:31.717Z",
          "LastModifiedDate": "2025-08-01T21:56:15.79Z"
        },
        {
          "VulnerabilityID": "CVE-2025-2099",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.50.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-2099",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Regular Expression Denial of Service (ReDoS) in huggingface/transformers",
          "Description": "A vulnerability in the `preprocess_string()` function of the `transformers.testing_utils` module in huggingface/transformers version v4.48.3 allows for a Regular Expression Denial of Service (ReDoS) attack. The regular expression used to process code blocks in docstrings contains nested quantifiers, leading to exponential backtracking when processing input with a large number of newline characters. An attacker can exploit this by providing a specially crafted payload, causing high CPU usage and potential application downtime, effectively resulting in a Denial of Service (DoS) scenario.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 3,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-2099",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/commit/8cb522b4190bd556ce51be04942720650b1a3e57",
            "https://github.com/huggingface/transformers/pull/36648",
            "https://github.com/pypa/advisory-database/tree/main/vulns/transformers/PYSEC-2025-40.yaml",
            "https://huntr.com/bounties/97b780f3-ffca-424f-ad5d-0e1c57a5bde4",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-2099",
            "https://www.cve.org/CVERecord?id=CVE-2025-2099"
          ],
          "PublishedDate": "2025-05-19T12:15:19.64Z",
          "LastModifiedDate": "2025-05-21T17:43:15.08Z"
        },
        {
          "VulnerabilityID": "CVE-2025-3263",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.51.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-3263",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Regular Expression Denial of Service (ReDoS) in huggingface/transformers",
          "Description": "A Regular Expression Denial of Service (ReDoS) vulnerability was discovered in the Hugging Face Transformers library, specifically in the `get_configuration_file()` function within the `transformers.configuration_utils` module. The affected version is 4.49.0, and the issue is resolved in version 4.51.0. The vulnerability arises from the use of a regular expression pattern `config\\.(.*)\\.json` that can be exploited to cause excessive CPU consumption through crafted input strings, leading to catastrophic backtracking. This can result in model serving disruption, resource exhaustion, and increased latency in applications using the library.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            },
            "redhat": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-3263",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/commit/0720e206c6ba28887e4d60ef60a6a089f6c1cc76",
            "https://github.com/huggingface/transformers/commit/126abe3461762e5fc180e7e614391d1b4ab051ca",
            "https://huntr.com/bounties/c7a69150-54f8-4e81-8094-791e7a2a0f29",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-3263",
            "https://www.cve.org/CVERecord?id=CVE-2025-3263"
          ],
          "PublishedDate": "2025-07-07T10:15:27.35Z",
          "LastModifiedDate": "2025-08-07T01:03:17.99Z"
        },
        {
          "VulnerabilityID": "CVE-2025-3264",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.51.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-3264",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Regular Expression Denial of Service (ReDoS) in huggingface/transformers",
          "Description": "A Regular Expression Denial of Service (ReDoS) vulnerability was discovered in the Hugging Face Transformers library, specifically in the `get_imports()` function within `dynamic_module_utils.py`. This vulnerability affects versions 4.49.0 and is fixed in version 4.51.0. The issue arises from a regular expression pattern `\\s*try\\s*:.*?except.*?:` used to filter out try/except blocks from Python code, which can be exploited to cause excessive CPU consumption through crafted input strings due to catastrophic backtracking. This vulnerability can lead to remote code loading disruption, resource exhaustion in model serving, supply chain attack vectors, and development pipeline disruption.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            },
            "redhat": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-3264",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/commit/0720e206c6ba28887e4d60ef60a6a089f6c1cc76",
            "https://github.com/huggingface/transformers/commit/126abe3461762e5fc180e7e614391d1b4ab051ca",
            "https://huntr.com/bounties/3c6f7822-9992-476d-8cf0-b0b1623427df",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-3264",
            "https://www.cve.org/CVERecord?id=CVE-2025-3264"
          ],
          "PublishedDate": "2025-07-07T10:15:27.5Z",
          "LastModifiedDate": "2025-08-07T01:02:30.7Z"
        },
        {
          "VulnerabilityID": "CVE-2025-3933",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.52.1",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-3933",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Regular Expression Denial of Service (ReDoS) in huggingface/transformers",
          "Description": "A Regular Expression Denial of Service (ReDoS) vulnerability was discovered in the Hugging Face Transformers library, specifically within the DonutProcessor class's `token2json()` method. This vulnerability affects versions 4.50.3 and earlier, and is fixed in version 4.52.1. The issue arises from the regex pattern `\u003cs_(.*?)\u003e` which can be exploited to cause excessive CPU consumption through crafted input strings due to catastrophic backtracking. This vulnerability can lead to service disruption, resource exhaustion, and potential API service vulnerabilities, impacting document processing tasks using the Donut model.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 2,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            },
            "redhat": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-3933",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/commit/ebbe9b12dd75b69f92100d684c47f923ee262a93",
            "https://github.com/huggingface/transformers/pull/37788",
            "https://huntr.com/bounties/25282953-5827-4384-bb6f-5790d275721b",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-3933",
            "https://www.cve.org/CVERecord?id=CVE-2025-3933"
          ],
          "PublishedDate": "2025-07-11T10:15:22.293Z",
          "LastModifiedDate": "2025-08-07T01:01:46.78Z"
        },
        {
          "VulnerabilityID": "CVE-2025-5197",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.53.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-5197",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Transformers ReDoS Vulnerability",
          "Description": "A Regular Expression Denial of Service (ReDoS) vulnerability exists in the Hugging Face Transformers library, specifically in the `convert_tf_weight_name_to_pt_weight_name()` function. This function, responsible for converting TensorFlow weight names to PyTorch format, uses a regex pattern `/[^/]*___([^/]*)/` that can be exploited to cause excessive CPU consumption through crafted input strings due to catastrophic backtracking. The vulnerability affects versions up to 4.51.3 and is fixed in version 4.53.0. This issue can lead to service disruption, resource exhaustion, and potential API service vulnerabilities, impacting model conversion processes between TensorFlow and PyTorch formats.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-1333"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "redhat": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-5197",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/commit/701caef704e356dc2f9331cc3fd5df0eccb4720a",
            "https://github.com/huggingface/transformers/commit/944b56000be5e9b61af8301aa340838770ad8a0b",
            "https://huntr.com/bounties/3f8b3fd0-166b-46e7-b60f-60dd9d2678bf",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-5197",
            "https://www.cve.org/CVERecord?id=CVE-2025-5197"
          ],
          "PublishedDate": "2025-08-06T12:15:26.837Z",
          "LastModifiedDate": "2025-08-06T20:23:37.6Z"
        },
        {
          "VulnerabilityID": "CVE-2024-3568",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.38.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-3568",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "Transformers Deserialization of Untrusted Data vulnerability",
          "Description": "The huggingface/transformers library is vulnerable to arbitrary code execution through deserialization of untrusted data within the `load_repo_checkpoint()` function of the `TFPreTrainedModel()` class. Attackers can execute arbitrary code and commands by crafting a malicious serialized payload, exploiting the use of `pickle.load()` on data from potentially untrusted sources. This vulnerability allows for remote code execution (RCE) by deceiving victims into loading a seemingly harmless checkpoint during a normal training process, thereby enabling attackers to execute arbitrary code on the targeted machine.",
          "Severity": "LOW",
          "CweIDs": [
            "CWE-502"
          ],
          "VendorSeverity": {
            "ghsa": 1
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:N/A:L",
              "V3Score": 3.4
            }
          },
          "References": [
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/commit/693667b8ac8138b83f8adb6522ddaf42fa07c125",
            "https://huntr.com/bounties/b3c36992-5264-4d7f-9906-a996efafba8f",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-3568"
          ],
          "PublishedDate": "2024-04-10T17:15:58.16Z",
          "LastModifiedDate": "2024-11-21T09:29:53.77Z"
        },
        {
          "VulnerabilityID": "CVE-2025-3777",
          "PkgName": "transformers",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/transformers@4.36.2",
            "UID": "6071148694869c55"
          },
          "InstalledVersion": "4.36.2",
          "FixedVersion": "4.52.1",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-3777",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "transformers: Improper Input Validation in huggingface/transformers",
          "Description": "Hugging Face Transformers versions up to 4.49.0 are affected by an improper input validation vulnerability in the `image_utils.py` file. The vulnerability arises from insecure URL validation using the `startswith()` method, which can be bypassed through URL username injection. This allows attackers to craft URLs that appear to be from YouTube but resolve to malicious domains, potentially leading to phishing attacks, malware distribution, or data exfiltration. The issue is fixed in version 4.52.1.",
          "Severity": "LOW",
          "CweIDs": [
            "CWE-20"
          ],
          "VendorSeverity": {
            "ghsa": 1,
            "redhat": 1
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N",
              "V3Score": 3.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N",
              "V3Score": 3.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-3777",
            "https://github.com/huggingface/transformers",
            "https://github.com/huggingface/transformers/blame/a7d2bbaaa8aac64f7c1ee8c1421cfe84b38359a4/src/transformers/image_utils.py",
            "https://github.com/huggingface/transformers/commit/4dda5f71b35fb70cf602187eef84bb17a50b9082",
            "https://huntr.com/bounties/ccba0730-9248-4853-b7ff-5c20e6364f09",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-3777",
            "https://www.cve.org/CVERecord?id=CVE-2025-3777"
          ],
          "PublishedDate": "2025-07-07T10:15:28.297Z",
          "LastModifiedDate": "2025-08-07T00:54:16.957Z"
        }
      ]
    },
    {
      "Target": "Dockerfile.api",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 27,
        "Failures": 0
      }
    },
    {
      "Target": "Dockerfile.frontend",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 27,
        "Failures": 0
      }
    },
    {
      "Target": "Dockerfile.python",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 27,
        "Failures": 0
      }
    },
    {
      "Target": "Dockerfile.rust",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 27,
        "Failures": 0
      }
    },
    {
      "Target": "data_pipeline.Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 26,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get update \u0026\u0026 apt-get install -y     wget     curl     gnupg     \u0026\u0026 rm -rf /var/lib/apt/lists/*'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 8,
            "EndLine": 12,
            "Code": {
              "Lines": [
                {
                  "Number": 8,
                  "Content": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    wget \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    wget \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "    curl \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    curl \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    gnupg \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    gnupg \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'wget -qO - https://aquasec.github.io/trivy-repo/deb/public.key | apt-key add -     \u0026\u0026 echo \"deb https://aquasec.github.io/trivy-repo/deb generic main\" | tee -a /etc/apt/sources.list     \u0026\u0026 apt-get update     \u0026\u0026 apt-get install -y trivy     \u0026\u0026 rm -rf /var/lib/apt/lists/*'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "RUN wget -qO - https://aquasec.github.io/trivy-repo/deb/public.key | apt-key add - \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "RUN wget -qO - https://aquasec.github.io/trivy-repo/deb/public.key | apt-key add - \\",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    \u0026\u0026 echo \"deb https://aquasec.github.io/trivy-repo/deb generic main\" | tee -a /etc/apt/sources.list \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 echo \"deb https://aquasec.github.io/trivy-repo/deb generic main\" | tee -a /etc/apt/sources.list \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "    \u0026\u0026 apt-get update \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 apt-get update \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "    \u0026\u0026 apt-get install -y trivy \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 apt-get install -y trivy \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/alertmanager-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 10
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'alertmanager' of Deployment 'alertmanager' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'alertmanager' of Deployment 'alertmanager' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'alertmanager' of Deployment 'alertmanager' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'alertmanager' of Deployment 'alertmanager' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'alertmanager' of Deployment 'alertmanager' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'alertmanager' of Deployment 'alertmanager' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"alertmanager\" of deployment \"alertmanager\" in \"monitoring\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment alertmanager in monitoring namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 41,
            "EndLine": 70,
            "Code": {
              "Lines": [
                {
                  "Number": 41,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 50,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container alertmanager in deployment alertmanager (namespace: monitoring) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "        - name: alertmanager",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: alertmanager",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "          image: prom/alertmanager:v0.27.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/alertmanager:v0.27.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/consul-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 13
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'consul' of Deployment 'consul' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'consul' of Deployment 'consul' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'consul' of 'deployment' 'consul' in 'vault' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'consul' of Deployment 'consul' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'consul' of Deployment 'consul' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'consul' of Deployment 'consul' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'consul' of Deployment 'consul' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"consul\" of deployment \"consul\" in \"vault\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container consul in vault namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment consul in vault namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container consul in deployment consul (namespace: vault) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "      - name: consul",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: consul",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        image: hashicorp/consul:1.17.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/consul:1.17.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          - \"agent\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"agent\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          - \"-server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"-bootstrap-expect=1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-bootstrap-expect=1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          - \"-ui\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-ui\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          - \"-data-dir=/consul/data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-data-dir=/consul/data\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          - \"-config-dir=/consul/config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"-config-dir=/consul/config\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/db-maintenance-cronjob.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 106,
        "Failures": 8
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'maintainer' of CronJob 'db-maintenance' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "            - name: maintainer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: maintainer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              image: postgres:16-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: postgres:16-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "                - name: PGPASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - \u001b[38;5;33mname\u001b[0m: PGPASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                  valueFrom:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mvalueFrom\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                    secretKeyRef:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33msecretKeyRef\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "                      name: smc-secrets",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mname\u001b[0m: smc-secrets",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "                      key: database-password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mkey\u001b[0m: database-password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'maintainer' of 'cronjob' 'db-maintenance' in 'smc-trading' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "            - name: maintainer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: maintainer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              image: postgres:16-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: postgres:16-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "                - name: PGPASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - \u001b[38;5;33mname\u001b[0m: PGPASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                  valueFrom:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mvalueFrom\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                    secretKeyRef:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33msecretKeyRef\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "                      name: smc-secrets",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mname\u001b[0m: smc-secrets",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "                      key: database-password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mkey\u001b[0m: database-password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'maintainer' of CronJob 'db-maintenance' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "            - name: maintainer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: maintainer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              image: postgres:16-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: postgres:16-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "                - name: PGPASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - \u001b[38;5;33mname\u001b[0m: PGPASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                  valueFrom:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mvalueFrom\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                    secretKeyRef:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33msecretKeyRef\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "                      name: smc-secrets",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mname\u001b[0m: smc-secrets",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "                      key: database-password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mkey\u001b[0m: database-password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'maintainer' of CronJob 'db-maintenance' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "            - name: maintainer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: maintainer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              image: postgres:16-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: postgres:16-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "                - name: PGPASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - \u001b[38;5;33mname\u001b[0m: PGPASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                  valueFrom:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mvalueFrom\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                    secretKeyRef:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33msecretKeyRef\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "                      name: smc-secrets",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mname\u001b[0m: smc-secrets",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "                      key: database-password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mkey\u001b[0m: database-password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "            - name: maintainer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: maintainer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              image: postgres:16-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: postgres:16-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "                - name: PGPASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - \u001b[38;5;33mname\u001b[0m: PGPASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                  valueFrom:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mvalueFrom\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                    secretKeyRef:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33msecretKeyRef\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "                      name: smc-secrets",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mname\u001b[0m: smc-secrets",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "                      key: database-password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mkey\u001b[0m: database-password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"maintainer\" of cronjob \"db-maintenance\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "            - name: maintainer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: maintainer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              image: postgres:16-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: postgres:16-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "                - name: PGPASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - \u001b[38;5;33mname\u001b[0m: PGPASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                  valueFrom:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mvalueFrom\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                    secretKeyRef:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33msecretKeyRef\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "                      name: smc-secrets",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mname\u001b[0m: smc-secrets",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "                      key: database-password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mkey\u001b[0m: database-password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "            - name: maintainer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: maintainer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              image: postgres:16-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: postgres:16-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "                - name: PGPASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - \u001b[38;5;33mname\u001b[0m: PGPASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                  valueFrom:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mvalueFrom\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                    secretKeyRef:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33msecretKeyRef\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "                      name: smc-secrets",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mname\u001b[0m: smc-secrets",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "                      key: database-password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33mkey\u001b[0m: database-password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "cronjob db-maintenance in smc-trading namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 19,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "          restartPolicy: OnFailure",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrestartPolicy\u001b[0m: OnFailure",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          serviceAccountName: smc-trading-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mserviceAccountName\u001b[0m: smc-trading-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "            - name: maintainer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: maintainer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "              image: postgres:16-alpine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: postgres:16-alpine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "              env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "                - name: PGPASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - \u001b[38;5;33mname\u001b[0m: PGPASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                  valueFrom:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mvalueFrom\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                    secretKeyRef:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33msecretKeyRef\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/ingress-controller.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-01010",
          "AVDID": "AVD-KSV-01010",
          "Title": "ConfigMap with sensitive content",
          "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
          "Message": "ConfigMap 'nginx-configuration' in 'ingress-nginx' namespace stores sensitive contents in key(s) or value(s) '{\"rate-limit-rps\"}'",
          "Namespace": "builtin.kubernetes.KSV01010",
          "Query": "data.builtin.kubernetes.KSV01010.deny",
          "Resolution": "Remove sensitive content from configMap data value",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-01010"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 1,
            "EndLine": 1,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "---",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "---",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-01010",
          "AVDID": "AVD-KSV-01010",
          "Title": "ConfigMap with sensitive content",
          "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
          "Message": "ConfigMap 'security-headers' in 'smc-trading' namespace stores sensitive contents in key(s) or value(s) '{\"X-Frame-Options\", \"geolocation\"}'",
          "Namespace": "builtin.kubernetes.KSV01010",
          "Query": "data.builtin.kubernetes.KSV01010.deny",
          "Resolution": "Remove sensitive content from configMap data value",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-01010"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 30,
            "EndLine": 30,
            "Code": {
              "Lines": [
                {
                  "Number": 30,
                  "Content": "---",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "---",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/kafka-cluster-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 25
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'kafka' of StatefulSet 'kafka' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'kafka-exporter' of StatefulSet 'kafka' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'kafka' of StatefulSet 'kafka' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'kafka-exporter' of StatefulSet 'kafka' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'kafka' of 'statefulset' 'kafka' in 'kafka' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'kafka-exporter' of 'statefulset' 'kafka' in 'kafka' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'kafka' of StatefulSet 'kafka' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'kafka-exporter' of StatefulSet 'kafka' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'kafka' of StatefulSet 'kafka' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'kafka-exporter' of StatefulSet 'kafka' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka' of StatefulSet 'kafka' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka-exporter' of StatefulSet 'kafka' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka' of StatefulSet 'kafka' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka-exporter' of StatefulSet 'kafka' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"kafka\" of statefulset \"kafka\" in \"kafka\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"kafka-exporter\" of statefulset \"kafka\" in \"kafka\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container kafka in kafka namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container kafka in kafka namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "statefulset kafka in kafka namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 56,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 56,
                  "Content": "      affinity:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33maffinity\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "        podAntiAffinity:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mpodAntiAffinity\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          requiredDuringSchedulingIgnoredDuringExecution:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequiredDuringSchedulingIgnoredDuringExecution\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "            - labelSelector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mlabelSelector\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "                matchExpressions:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33mmatchExpressions\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "                  - key: \"app\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  - \u001b[38;5;33mkey\u001b[0m: \u001b[38;5;37m\"app\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "                    operator: In",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m                    \u001b[38;5;33moperator\u001b[0m: In",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "                    values:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33mvalues\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "                      - kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      - kafka",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 65,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container kafka in statefulset kafka (namespace: kafka) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 67,
            "EndLine": 150,
            "Code": {
              "Lines": [
                {
                  "Number": 67,
                  "Content": "        - name: kafka",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            - containerPort: 9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "              name: internal",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: internal",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            - containerPort: 9093",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9093",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "              name: external",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: external",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container kafka-exporter in statefulset kafka (namespace: kafka) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 151,
            "EndLine": 166,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "        - name: kafka-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          image: danielqsj/kafka-exporter:v1.6.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: danielqsj/kafka-exporter:v1.6.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "            - containerPort: 9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "            - --kafka.server=localhost:9092",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --kafka.server=localhost:9092",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "            - --web.listen-address=:9308",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --web.listen-address=:9308",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "            - --log.level=info",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --log.level=info",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/kafka-connect-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 13
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'kafka-connect' of Deployment 'kafka-connect' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'kafka-connect' of Deployment 'kafka-connect' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'kafka-connect' of 'deployment' 'kafka-connect' in 'kafka' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'kafka-connect' of Deployment 'kafka-connect' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'kafka-connect' of Deployment 'kafka-connect' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka-connect' of Deployment 'kafka-connect' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka-connect' of Deployment 'kafka-connect' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"kafka-connect\" of deployment \"kafka-connect\" in \"kafka\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container kafka-connect in kafka namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment kafka-connect in kafka namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 64,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 64,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 73,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container kafka-connect in deployment kafka-connect (namespace: kafka) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 65,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "        - name: kafka-connect",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-connect",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "          image: confluentinc/cp-kafka-connect:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka-connect:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "            - containerPort: 8083",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8083",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "              name: rest-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: rest-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            - name: CONNECT_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: CONNECT_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "              value: \"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"kafka-0.kafka-service.kafka.svc.cluster.local:9092,kafka-1.kafka-service.kafka.svc.cluster.local:9092,kafka-2.kafka-service.kafka.svc.cluster.local:9092\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            - name: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: CONNECT_REST_ADVERTISED_HOST_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/kafka-monitoring.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 26
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'grafana' of Deployment 'kafka-grafana' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'prometheus' of Deployment 'kafka-prometheus' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'grafana' of Deployment 'kafka-grafana' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'prometheus' of Deployment 'kafka-prometheus' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'grafana' of 'deployment' 'kafka-grafana' in 'kafka' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'prometheus' of 'deployment' 'kafka-prometheus' in 'kafka' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'grafana' of Deployment 'kafka-grafana' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'prometheus' of Deployment 'kafka-prometheus' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'grafana' of Deployment 'kafka-grafana' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'prometheus' of Deployment 'kafka-prometheus' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'grafana' of Deployment 'kafka-grafana' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'prometheus' of Deployment 'kafka-prometheus' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'grafana' of Deployment 'kafka-grafana' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'prometheus' of Deployment 'kafka-prometheus' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"grafana\" of deployment \"kafka-grafana\" in \"kafka\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"prometheus\" of deployment \"kafka-prometheus\" in \"kafka\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container kafka-grafana in kafka namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container kafka-prometheus in kafka namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment kafka-grafana in kafka namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 291,
            "EndLine": 331,
            "Code": {
              "Lines": [
                {
                  "Number": 291,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 300,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment kafka-prometheus in kafka namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 129,
            "EndLine": 171,
            "Code": {
              "Lines": [
                {
                  "Number": 129,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 138,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container grafana in deployment kafka-grafana (namespace: kafka) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 292,
            "EndLine": 325,
            "Code": {
              "Lines": [
                {
                  "Number": 292,
                  "Content": "        - name: grafana",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: grafana",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 293,
                  "Content": "          image: grafana/grafana:10.0.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: grafana/grafana:10.0.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 294,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 295,
                  "Content": "            - containerPort: 3000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "            - name: GF_SECURITY_ADMIN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "              value: \"admin123\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"admin123\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "            - name: GF_INSTALL_PLUGINS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;33mname\u001b[0m: GF_INSTALL_PLUGINS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 301,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container prometheus in deployment kafka-prometheus (namespace: kafka) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 130,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 130,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "          image: prom/prometheus:v2.45.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.45.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "            - containerPort: 9090",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "              name: web",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: web",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "            - \"--config.file=/etc/prometheus/prometheus.yml\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;37m\"--config.file=/etc/prometheus/prometheus.yml\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "            - \"--storage.tsdb.path=/prometheus\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--storage.tsdb.path=/prometheus\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "            - \"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            - \u001b[38;5;37m\"--web.console.libraries=/etc/prometheus/console_libraries\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/kafka-namespace.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/kafka-streams-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 14
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'kafka-streams' of Deployment 'kafka-streams' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'kafka-streams' of Deployment 'kafka-streams' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'kafka-streams' of 'deployment' 'kafka-streams' in 'smc-trading' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'kafka-streams' of Deployment 'kafka-streams' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'kafka-streams' of Deployment 'kafka-streams' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'kafka-streams' of Deployment 'kafka-streams' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka-streams' of Deployment 'kafka-streams' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka-streams' of Deployment 'kafka-streams' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"kafka-streams\" of deployment \"kafka-streams\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container kafka-streams in smc-trading namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment kafka-streams in smc-trading namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 100,
            "EndLine": 178,
            "Code": {
              "Lines": [
                {
                  "Number": 100,
                  "Content": "      affinity:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33maffinity\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "        podAntiAffinity:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mpodAntiAffinity\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "          preferredDuringSchedulingIgnoredDuringExecution:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mpreferredDuringSchedulingIgnoredDuringExecution\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "            - weight: 100",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mweight\u001b[0m: \u001b[38;5;37m100",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "              podAffinityTerm:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mpodAffinityTerm\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "                labelSelector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33mlabelSelector\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "                  matchExpressions:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  \u001b[38;5;33mmatchExpressions\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "                    - key: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    - \u001b[38;5;33mkey\u001b[0m: app",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "                      operator: In",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      \u001b[38;5;33moperator\u001b[0m: In",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 109,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container kafka-streams in deployment kafka-streams (namespace: smc-trading) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 113,
            "EndLine": 170,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "        - name: kafka-streams",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-streams",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          image: smc-trading/stream-processor:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: smc-trading/stream-processor:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "            - containerPort: 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "              name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "            - containerPort: 8081",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8081",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "              name: health",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: health",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "          env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "            - name: KAFKA_BOOTSTRAP_SERVERS",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: KAFKA_BOOTSTRAP_SERVERS",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/kafka-topics-job.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 102,
        "Failures": 13
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'kafka-topics-setup' of Job 'kafka-topics-setup' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'kafka-topics-setup' of Job 'kafka-topics-setup' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'kafka-topics-setup' of 'job' 'kafka-topics-setup' in 'kafka' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'kafka-topics-setup' of Job 'kafka-topics-setup' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'kafka-topics-setup' of Job 'kafka-topics-setup' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka-topics-setup' of Job 'kafka-topics-setup' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'kafka-topics-setup' of Job 'kafka-topics-setup' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"kafka-topics-setup\" of job \"kafka-topics-setup\" in \"kafka\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container kafka-topics-setup in kafka namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "job kafka-topics-setup in kafka namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 11,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 11,
                  "Content": "      restartPolicy: OnFailure",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mrestartPolicy\u001b[0m: OnFailure",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container kafka-topics-setup in job kafka-topics-setup (namespace: kafka) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 13,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "        - name: kafka-topics-setup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: kafka-topics-setup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          image: confluentinc/cp-kafka:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-kafka:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "          command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "              set -e",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              set -e",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              # Wait for Kafka to be ready",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              # Wait for Kafka to be ready",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/namespace.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/network-policies.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/pgbouncer-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 11
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'pgbouncer' of Deployment 'pgbouncer' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 87,
            "EndLine": 144,
            "Code": {
              "Lines": [
                {
                  "Number": 87,
                  "Content": "      - name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "        image: pgbouncer/pgbouncer:1.21.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: pgbouncer/pgbouncer:1.21.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        - containerPort: 6432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "          name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        - name: DATABASES_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASES_HOST",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'pgbouncer' of Deployment 'pgbouncer' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 87,
            "EndLine": 144,
            "Code": {
              "Lines": [
                {
                  "Number": 87,
                  "Content": "      - name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "        image: pgbouncer/pgbouncer:1.21.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: pgbouncer/pgbouncer:1.21.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        - containerPort: 6432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "          name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        - name: DATABASES_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASES_HOST",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'pgbouncer-exporter' of Deployment 'pgbouncer' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 147,
            "EndLine": 178,
            "Code": {
              "Lines": [
                {
                  "Number": 147,
                  "Content": "      - name: pgbouncer-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "        image: prometheuscommunity/pgbouncer-exporter:v0.7.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prometheuscommunity/pgbouncer-exporter:v0.7.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "        - name: PGBOUNCER_EXPORTER_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PGBOUNCER_EXPORTER_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "          value: \"localhost\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"localhost\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: PGBOUNCER_EXPORTER_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PGBOUNCER_EXPORTER_PORT",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 156,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 87,
            "EndLine": 144,
            "Code": {
              "Lines": [
                {
                  "Number": 87,
                  "Content": "      - name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "        image: pgbouncer/pgbouncer:1.21.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: pgbouncer/pgbouncer:1.21.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        - containerPort: 6432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "          name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        - name: DATABASES_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASES_HOST",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 147,
            "EndLine": 178,
            "Code": {
              "Lines": [
                {
                  "Number": 147,
                  "Content": "      - name: pgbouncer-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "        image: prometheuscommunity/pgbouncer-exporter:v0.7.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prometheuscommunity/pgbouncer-exporter:v0.7.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "        - name: PGBOUNCER_EXPORTER_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PGBOUNCER_EXPORTER_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "          value: \"localhost\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"localhost\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: PGBOUNCER_EXPORTER_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PGBOUNCER_EXPORTER_PORT",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 156,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-01010",
          "AVDID": "AVD-KSV-01010",
          "Title": "ConfigMap with sensitive content",
          "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
          "Message": "ConfigMap 'pgbouncer-config' in 'smc-trading' namespace stores sensitive contents in key(s) or value(s) '{\"auth_type \"}'",
          "Namespace": "builtin.kubernetes.KSV01010",
          "Query": "data.builtin.kubernetes.KSV01010.deny",
          "Resolution": "Remove sensitive content from configMap data value",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-01010"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general"
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"pgbouncer\" of deployment \"pgbouncer\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 87,
            "EndLine": 144,
            "Code": {
              "Lines": [
                {
                  "Number": 87,
                  "Content": "      - name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "        image: pgbouncer/pgbouncer:1.21.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: pgbouncer/pgbouncer:1.21.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        - containerPort: 6432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "          name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        - name: DATABASES_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASES_HOST",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"pgbouncer-exporter\" of deployment \"pgbouncer\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 147,
            "EndLine": 178,
            "Code": {
              "Lines": [
                {
                  "Number": 147,
                  "Content": "      - name: pgbouncer-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "        image: prometheuscommunity/pgbouncer-exporter:v0.7.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prometheuscommunity/pgbouncer-exporter:v0.7.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "        - name: PGBOUNCER_EXPORTER_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PGBOUNCER_EXPORTER_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "          value: \"localhost\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"localhost\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: PGBOUNCER_EXPORTER_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PGBOUNCER_EXPORTER_PORT",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 156,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment pgbouncer in smc-trading namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 86,
            "EndLine": 199,
            "Code": {
              "Lines": [
                {
                  "Number": 86,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      - name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "        image: pgbouncer/pgbouncer:1.21.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: pgbouncer/pgbouncer:1.21.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        - containerPort: 6432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "          name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 95,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container pgbouncer in deployment pgbouncer (namespace: smc-trading) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 87,
            "EndLine": 144,
            "Code": {
              "Lines": [
                {
                  "Number": 87,
                  "Content": "      - name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "        image: pgbouncer/pgbouncer:1.21.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: pgbouncer/pgbouncer:1.21.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        - containerPort: 6432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "          name: pgbouncer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: pgbouncer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        - name: DATABASES_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASES_HOST",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container pgbouncer-exporter in deployment pgbouncer (namespace: smc-trading) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 147,
            "EndLine": 178,
            "Code": {
              "Lines": [
                {
                  "Number": 147,
                  "Content": "      - name: pgbouncer-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: pgbouncer-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "        image: prometheuscommunity/pgbouncer-exporter:v0.7.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prometheuscommunity/pgbouncer-exporter:v0.7.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        - containerPort: 9127",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9127",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "        - name: PGBOUNCER_EXPORTER_HOST",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: PGBOUNCER_EXPORTER_HOST",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "          value: \"localhost\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"localhost\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: PGBOUNCER_EXPORTER_PORT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: PGBOUNCER_EXPORTER_PORT",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 156,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/postgresql-ha-cluster.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 29
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'etcd' of StatefulSet 'etcd' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'etcd' of StatefulSet 'etcd' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'etcd' of 'statefulset' 'etcd' in 'smc-trading' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'etcd' of StatefulSet 'etcd' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'postgresql' of StatefulSet 'postgresql-ha' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'postgresql' of StatefulSet 'postgresql-ha' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'etcd' of StatefulSet 'etcd' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'postgresql' of StatefulSet 'postgresql-ha' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'etcd' of StatefulSet 'etcd' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'postgresql' of StatefulSet 'postgresql-ha' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'etcd' of StatefulSet 'etcd' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'postgres-exporter' of StatefulSet 'postgresql-ha' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 343,
            "EndLine": 375,
            "Code": {
              "Lines": [
                {
                  "Number": 343,
                  "Content": "      - name: postgres-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 344,
                  "Content": "        image: prometheuscommunity/postgres-exporter:v0.12.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prometheuscommunity/postgres-exporter:v0.12.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 345,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 346,
                  "Content": "        - containerPort: 9187",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9187",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 347,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 348,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 349,
                  "Content": "        - name: DATA_SOURCE_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATA_SOURCE_NAME",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 350,
                  "Content": "          value: \"postgresql://postgres_exporter:$(POSTGRES_EXPORTER_PASSWORD)@localhost:5432/smc_trading_agent?sslmode=disable\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"postgresql://postgres_exporter:$(POSTGRES_EXPORTER_PASSWORD)@localhost:5432/smc_trading_agent?sslmode=disable\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 351,
                  "Content": "        - name: POSTGRES_EXPORTER_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: POSTGRES_EXPORTER_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 352,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'postgresql' of StatefulSet 'postgresql-ha' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV022",
          "AVDID": "AVD-KSV-0022",
          "Title": "Specific capabilities added",
          "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
          "Message": "Container 'postgresql' of StatefulSet 'postgresql-ha' should not set 'securityContext.capabilities.add'",
          "Namespace": "builtin.kubernetes.KSV022",
          "Query": "data.builtin.kubernetes.KSV022.deny",
          "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv022"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 343,
            "EndLine": 375,
            "Code": {
              "Lines": [
                {
                  "Number": 343,
                  "Content": "      - name: postgres-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 344,
                  "Content": "        image: prometheuscommunity/postgres-exporter:v0.12.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prometheuscommunity/postgres-exporter:v0.12.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 345,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 346,
                  "Content": "        - containerPort: 9187",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9187",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 347,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 348,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 349,
                  "Content": "        - name: DATA_SOURCE_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATA_SOURCE_NAME",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 350,
                  "Content": "          value: \"postgresql://postgres_exporter:$(POSTGRES_EXPORTER_PASSWORD)@localhost:5432/smc_trading_agent?sslmode=disable\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"postgresql://postgres_exporter:$(POSTGRES_EXPORTER_PASSWORD)@localhost:5432/smc_trading_agent?sslmode=disable\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 351,
                  "Content": "        - name: POSTGRES_EXPORTER_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: POSTGRES_EXPORTER_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 352,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-01010",
          "AVDID": "AVD-KSV-01010",
          "Title": "ConfigMap with sensitive content",
          "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
          "Message": "ConfigMap 'patroni-config' in 'smc-trading' namespace stores sensitive contents in key(s) or value(s) '{\"      username\", \"    username\"}'",
          "Namespace": "builtin.kubernetes.KSV01010",
          "Query": "data.builtin.kubernetes.KSV01010.deny",
          "Resolution": "Remove sensitive content from configMap data value",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-01010"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 108,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 108,
                  "Content": "---",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "---",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"etcd\" of statefulset \"etcd\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"postgres-exporter\" of statefulset \"postgresql-ha\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 343,
            "EndLine": 375,
            "Code": {
              "Lines": [
                {
                  "Number": 343,
                  "Content": "      - name: postgres-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 344,
                  "Content": "        image: prometheuscommunity/postgres-exporter:v0.12.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prometheuscommunity/postgres-exporter:v0.12.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 345,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 346,
                  "Content": "        - containerPort: 9187",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9187",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 347,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 348,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 349,
                  "Content": "        - name: DATA_SOURCE_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATA_SOURCE_NAME",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 350,
                  "Content": "          value: \"postgresql://postgres_exporter:$(POSTGRES_EXPORTER_PASSWORD)@localhost:5432/smc_trading_agent?sslmode=disable\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"postgresql://postgres_exporter:$(POSTGRES_EXPORTER_PASSWORD)@localhost:5432/smc_trading_agent?sslmode=disable\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 351,
                  "Content": "        - name: POSTGRES_EXPORTER_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: POSTGRES_EXPORTER_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 352,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"postgresql\" of statefulset \"postgresql-ha\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should not add stuff",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 333,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 333,
                  "Content": "            drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 334,
                  "Content": "            - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - ALL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 335,
                  "Content": "            add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 336,
                  "Content": "            - CHOWN",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - CHOWN",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 337,
                  "Content": "            - DAC_OVERRIDE",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - DAC_OVERRIDE",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 338,
                  "Content": "            - FOWNER",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - FOWNER",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 339,
                  "Content": "            - SETGID",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - SETGID",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 340,
                  "Content": "            - SETUID",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - SETUID",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-0109",
          "AVDID": "AVD-KSV-0109",
          "Title": "ConfigMap with secrets",
          "Description": "Storing secrets in configMaps is unsafe",
          "Message": "ConfigMap 'patroni-config' in 'smc-trading' namespace stores secrets in key(s) or value(s) '{\"      password\", \"    password\"}'",
          "Namespace": "builtin.kubernetes.KSV0109",
          "Query": "data.builtin.kubernetes.KSV0109.deny",
          "Resolution": "Remove password/secret from configMap data value",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-0109",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-0109"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 108,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 108,
                  "Content": "---",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "---",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container etcd in smc-trading namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "statefulset etcd in smc-trading namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 28,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container etcd in statefulset etcd (namespace: smc-trading) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: etcd",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: etcd",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: quay.io/coreos/etcd:v3.5.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: quay.io/coreos/etcd:v3.5.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - containerPort: 2379",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2379",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        - containerPort: 2380",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2380",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "          name: peer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: peer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - name: ETCD_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ETCD_NAME",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container postgres-exporter in statefulset postgresql-ha (namespace: smc-trading) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 343,
            "EndLine": 375,
            "Code": {
              "Lines": [
                {
                  "Number": 343,
                  "Content": "      - name: postgres-exporter",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres-exporter",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 344,
                  "Content": "        image: prometheuscommunity/postgres-exporter:v0.12.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prometheuscommunity/postgres-exporter:v0.12.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 345,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 346,
                  "Content": "        - containerPort: 9187",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9187",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 347,
                  "Content": "          name: metrics",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: metrics",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 348,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 349,
                  "Content": "        - name: DATA_SOURCE_NAME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATA_SOURCE_NAME",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 350,
                  "Content": "          value: \"postgresql://postgres_exporter:$(POSTGRES_EXPORTER_PASSWORD)@localhost:5432/smc_trading_agent?sslmode=disable\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"postgresql://postgres_exporter:$(POSTGRES_EXPORTER_PASSWORD)@localhost:5432/smc_trading_agent?sslmode=disable\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 351,
                  "Content": "        - name: POSTGRES_EXPORTER_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: POSTGRES_EXPORTER_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 352,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container postgresql in statefulset postgresql-ha (namespace: smc-trading) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 253,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 253,
                  "Content": "      - name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "        image: smc-trading/postgresql-ha:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-trading/postgresql-ha:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        - containerPort: 5432",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "          name: postgresql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: postgresql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "        - containerPort: 8008",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8008",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 259,
                  "Content": "          name: patroni-api",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mname\u001b[0m: patroni-api",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "        - name: POD_IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POD_IP",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 262,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/production/production-patches.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 102,
        "Failures": 13
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'smc-agent' of 'deployment' 'smc-trading-agent' in 'smc-trading-production' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"smc-agent\" of deployment \"smc-trading-agent\" in \"smc-trading-production\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container smc-trading-agent in smc-trading-production namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment smc-trading-agent in smc-trading-production namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 14,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"INFO\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"INFO\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/prometheus-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 10
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'prometheus' of Deployment 'prometheus' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'prometheus' of Deployment 'prometheus' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'prometheus' of Deployment 'prometheus' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'prometheus' of Deployment 'prometheus' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'prometheus' of Deployment 'prometheus' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'prometheus' of Deployment 'prometheus' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"prometheus\" of deployment \"prometheus\" in \"monitoring\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment prometheus in monitoring namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 68,
            "EndLine": 105,
            "Code": {
              "Lines": [
                {
                  "Number": 68,
                  "Content": "      serviceAccountName: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mserviceAccountName\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container prometheus in deployment prometheus (namespace: monitoring) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 70,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 70,
                  "Content": "        - name: prometheus",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: prometheus",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "          image: prom/prometheus:v2.52.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: prom/prometheus:v2.52.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "          securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            allowPrivilegeEscalation: false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            readOnlyRootFilesystem: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "            runAsNonRoot: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "              drop:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mdrop\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "                - ALL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - ALL",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/prometheus-rules-configmap.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/rbac.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV047",
          "AVDID": "AVD-KSV-0047",
          "Title": "Do not allow privilege escalation from node proxy",
          "Description": "Check whether role permits privilege escalation from node proxy",
          "Message": "Role permits privilege escalation from node proxy",
          "Namespace": "builtin.kubernetes.KSV047",
          "Query": "data.builtin.kubernetes.KSV047.deny",
          "Resolution": "Create a role which does not permit privilege escalation from node proxy",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv047",
          "References": [
            "https://kubernetes.io/docs/concepts/security/rbac-good-practices/",
            "https://avd.aquasec.com/misconfig/ksv047"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 69,
            "EndLine": 71,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "- apiGroups: [\"\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "- \u001b[38;5;33mapiGroups\u001b[0m: [\u001b[38;5;37m\"\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  resources: [\"nodes\", \"nodes/proxy\", \"services\", \"endpoints\", \"pods\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mresources\u001b[0m: [\u001b[38;5;37m\"nodes\"\u001b[0m, \u001b[38;5;37m\"nodes/proxy\"\u001b[0m, \u001b[38;5;37m\"services\"\u001b[0m, \u001b[38;5;37m\"endpoints\"\u001b[0m, \u001b[38;5;37m\"pods\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  verbs: [\"get\", \"list\", \"watch\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mverbs\u001b[0m: [\u001b[38;5;37m\"get\"\u001b[0m, \u001b[38;5;37m\"list\"\u001b[0m, \u001b[38;5;37m\"watch\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV113",
          "AVDID": "AVD-KSV-0113",
          "Title": "Manage namespace secrets",
          "Description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.",
          "Message": "Role 'smc-trading-role' shouldn't have access to manage secrets in namespace 'smc-trading'",
          "Namespace": "builtin.kubernetes.KSV113",
          "Query": "data.builtin.kubernetes.KSV113.deny",
          "Resolution": "Manage namespace secrets are not allowed. Remove resource 'secrets' from role",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv113",
          "References": [
            "https://kubernetes.io/docs/concepts/security/rbac-good-practices/",
            "https://avd.aquasec.com/misconfig/ksv113"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "- apiGroups: [\"\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "- \u001b[38;5;33mapiGroups\u001b[0m: [\u001b[38;5;37m\"\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  resources: [\"pods\", \"services\", \"endpoints\", \"configmaps\", \"secrets\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mresources\u001b[0m: [\u001b[38;5;37m\"pods\"\u001b[0m, \u001b[38;5;37m\"services\"\u001b[0m, \u001b[38;5;37m\"endpoints\"\u001b[0m, \u001b[38;5;37m\"configmaps\"\u001b[0m, \u001b[38;5;37m\"secrets\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  verbs: [\"get\", \"list\", \"watch\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mverbs\u001b[0m: [\u001b[38;5;37m\"get\"\u001b[0m, \u001b[38;5;37m\"list\"\u001b[0m, \u001b[38;5;37m\"watch\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/secret-validation-cronjob.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 106,
        "Failures": 8
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'validator' of CronJob 'smc-secret-validation' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 28,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "            - name: validator",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: validator",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "              image: python:3.10-slim",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: python:3.10-slim",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "                - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "                  python - \u003c\u003c'PY'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m                  python - \u003c\u003c'PY'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "                  import os, sys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  import os, sys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "                  required = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  required = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'validator' of 'cronjob' 'smc-secret-validation' in 'smc-trading' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 28,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "            - name: validator",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: validator",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "              image: python:3.10-slim",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: python:3.10-slim",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "                - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "                  python - \u003c\u003c'PY'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m                  python - \u003c\u003c'PY'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "                  import os, sys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  import os, sys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "                  required = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  required = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'validator' of CronJob 'smc-secret-validation' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 28,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "            - name: validator",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: validator",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "              image: python:3.10-slim",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: python:3.10-slim",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "                - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "                  python - \u003c\u003c'PY'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m                  python - \u003c\u003c'PY'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "                  import os, sys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  import os, sys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "                  required = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  required = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'validator' of CronJob 'smc-secret-validation' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 28,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "            - name: validator",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: validator",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "              image: python:3.10-slim",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: python:3.10-slim",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "                - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "                  python - \u003c\u003c'PY'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m                  python - \u003c\u003c'PY'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "                  import os, sys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  import os, sys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "                  required = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  required = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 28,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "            - name: validator",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: validator",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "              image: python:3.10-slim",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: python:3.10-slim",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "                - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "                  python - \u003c\u003c'PY'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m                  python - \u003c\u003c'PY'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "                  import os, sys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  import os, sys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "                  required = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  required = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"validator\" of cronjob \"smc-secret-validation\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 28,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "            - name: validator",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: validator",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "              image: python:3.10-slim",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: python:3.10-slim",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "                - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "                  python - \u003c\u003c'PY'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m                  python - \u003c\u003c'PY'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "                  import os, sys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  import os, sys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "                  required = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  required = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 28,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "            - name: validator",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: validator",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "              image: python:3.10-slim",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: python:3.10-slim",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "                - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "                  python - \u003c\u003c'PY'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m                  python - \u003c\u003c'PY'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "                  import os, sys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  import os, sys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "                  required = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  required = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "cronjob smc-secret-validation in smc-trading namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 25,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "          restartPolicy: OnFailure",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrestartPolicy\u001b[0m: OnFailure",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          serviceAccountName: smc-trading-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mserviceAccountName\u001b[0m: smc-trading-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "            - name: validator",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mname\u001b[0m: validator",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "              image: python:3.10-slim",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimage\u001b[0m: python:3.10-slim",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "              imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              command: [\"/bin/sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "                - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                - |",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 34,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/smc-agent-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 6
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 46,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "        image: smc-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"/bin/sh\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 55,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 46,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "        image: smc-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"/bin/sh\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 55,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 46,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "        image: smc-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"/bin/sh\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 55,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 46,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "        image: smc-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"/bin/sh\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 55,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"smc-agent\" of deployment \"smc-trading-agent\" in \"smc-trading\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 46,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "        image: smc-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"/bin/sh\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sh\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 55,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment smc-trading-agent in smc-trading namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 44,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "      serviceAccountName: smc-trading-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mserviceAccountName\u001b[0m: smc-trading-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "        image: smc-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: smc-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "          value: \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/smc-trading-namespace.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/staging/staging-patches.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 102,
        "Failures": 13
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'smc-agent' of 'deployment' 'smc-trading-agent' in 'smc-trading-staging' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'smc-agent' of Deployment 'smc-trading-agent' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"smc-agent\" of deployment \"smc-trading-agent\" in \"smc-trading-staging\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container smc-trading-agent in smc-trading-staging namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment smc-trading-agent in smc-trading-staging namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 14,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "      - name: smc-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: smc-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - name: ENVIRONMENT",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: ENVIRONMENT",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          value: \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        - name: LOG_LEVEL",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: LOG_LEVEL",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          value: \"DEBUG\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"DEBUG\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          value: \"http://vault.vault.svc.cluster.local:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://vault.vault.svc.cluster.local:8200\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/vault-agent-configmap.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 112,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-01010",
          "AVDID": "AVD-KSV-01010",
          "Title": "ConfigMap with sensitive content",
          "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
          "Message": "ConfigMap 'vault-agent-config' in 'smc-trading' namespace stores sensitive contents in key(s) or value(s) '{\"BINANCE_API_KEY\", \"BYBIT_API_KEY\", \"ENCRYPTION_KEY\", \"OANDA_API_KEY\"}'",
          "Namespace": "builtin.kubernetes.KSV01010",
          "Query": "data.builtin.kubernetes.KSV01010.deny",
          "Resolution": "Remove sensitive content from configMap data value",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-01010"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general"
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-0109",
          "AVDID": "AVD-KSV-0109",
          "Title": "ConfigMap with secrets",
          "Description": "Storing secrets in configMaps is unsafe",
          "Message": "ConfigMap 'vault-agent-config' in 'smc-trading' namespace stores secrets in key(s) or value(s) '{\"BINANCE_API_SECRET\", \"BYBIT_API_SECRET\", \"DATABASE_PASSWORD\", \"JWT_SECRET\"}'",
          "Namespace": "builtin.kubernetes.KSV0109",
          "Query": "data.builtin.kubernetes.KSV0109.deny",
          "Resolution": "Remove password/secret from configMap data value",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-0109",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-0109"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general"
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/vault-configmap.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/vault-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 13
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'vault' of Deployment 'vault' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'vault' of Deployment 'vault' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'vault' of 'deployment' 'vault' in 'vault' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'vault' of Deployment 'vault' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'vault' of Deployment 'vault' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'vault' of Deployment 'vault' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'vault' of Deployment 'vault' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV022",
          "AVDID": "AVD-KSV-0022",
          "Title": "Specific capabilities added",
          "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
          "Message": "Container 'vault' of Deployment 'vault' should not set 'securityContext.capabilities.add'",
          "Namespace": "builtin.kubernetes.KSV022",
          "Query": "data.builtin.kubernetes.KSV022.deny",
          "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv022"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"vault\" of deployment \"vault\" in \"vault\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment vault in vault namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 84,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      serviceAccountName: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mserviceAccountName\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container vault in deployment vault (namespace: vault) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 77,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "      - name: vault",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: vault",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        image: hashicorp/vault:1.15.4",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: hashicorp/vault:1.15.4",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        imagePullPolicy: IfNotPresent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          - \"server\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"server\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        - name: VAULT_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: VAULT_ADDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          value: \"http://127.0.0.1:8200\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://127.0.0.1:8200\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "        - name: VAULT_API_ADDR",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: VAULT_API_ADDR",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/kubernetes/vault-namespace.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/vault-pvc.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/waf-configmap.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 0
      }
    },
    {
      "Target": "deployment/kubernetes/zookeeper-deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 114,
        "Failures": 13
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'zookeeper' of StatefulSet 'zookeeper' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'zookeeper' of StatefulSet 'zookeeper' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'zookeeper' of 'statefulset' 'zookeeper' in 'kafka' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'zookeeper' of StatefulSet 'zookeeper' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'zookeeper' of StatefulSet 'zookeeper' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'zookeeper' of StatefulSet 'zookeeper' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'zookeeper' of StatefulSet 'zookeeper' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"zookeeper\" of statefulset \"zookeeper\" in \"kafka\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container zookeeper in kafka namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "statefulset zookeeper in kafka namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 38,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "      affinity:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33maffinity\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "        podAntiAffinity:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mpodAntiAffinity\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "          requiredDuringSchedulingIgnoredDuringExecution:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrequiredDuringSchedulingIgnoredDuringExecution\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "            - labelSelector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mlabelSelector\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "                matchExpressions:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33mmatchExpressions\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "                  - key: \"app\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                  - \u001b[38;5;33mkey\u001b[0m: \u001b[38;5;37m\"app\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "                    operator: In",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m                    \u001b[38;5;33moperator\u001b[0m: In",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "                    values:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    \u001b[38;5;33mvalues\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "                      - zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                      - zookeeper",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV0125",
          "AVDID": "AVD-KSV-0125",
          "Title": "Restrict container images to trusted registries",
          "Description": "Ensure that all containers use images only from trusted registry domains.",
          "Message": "Container zookeeper in statefulset zookeeper (namespace: kafka) uses an image from an untrusted registry.",
          "Namespace": "builtin.kubernetes.KSV0125",
          "Query": "data.builtin.kubernetes.KSV0125.deny",
          "Resolution": "Use images from trusted registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv0125",
          "References": [
            "https://cloud.google.com/container-registry/docs/overview#registries",
            "https://docs.aws.amazon.com/general/latest/gr/ecr.html",
            "https://avd.aquasec.com/misconfig/ksv0125"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 108,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "        - name: zookeeper",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: zookeeper",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "          image: confluentinc/cp-zookeeper:7.4.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: confluentinc/cp-zookeeper:7.4.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            - containerPort: 2181",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2181",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "              name: client",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: client",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "            - containerPort: 2888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m2888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "              name: server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "            - containerPort: 3888",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3888",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "              name: leader-election",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m              \u001b[38;5;33mname\u001b[0m: leader-election",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/pgbouncer/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 26,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get update \u0026\u0026 apt-get install -y     curl     netcat-openbsd     \u0026\u0026 rm -rf /var/lib/apt/lists/*'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 5,
            "EndLine": 8,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get update \u001b[38;5;245m\u0026\u0026\u001b[0m apt-get install -y \u001b[38;5;124m\\",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    curl \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    curl \u001b[38;5;124m\\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    netcat-openbsd \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    netcat-openbsd \u001b[38;5;124m\\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245m\u0026\u0026\u001b[0m rm -rf /var/lib/apt/lists/*",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "deployment/postgresql-ha/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 27,
        "Failures": 0
      }
    },
    {
      "Target": "node_modules/.pnpm/redoc-cli@0.13.21_@babel+core@7.28.0_core-js@3.45.0_react-is@19.1.1_webpack@5.101.1/node_modules/redoc-cli/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 25,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS002",
          "AVDID": "AVD-DS-0002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
          "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
          "Namespace": "builtin.dockerfile.DS002",
          "Query": "data.builtin.dockerfile.DS002.deny",
          "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds002"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general"
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS026",
          "AVDID": "AVD-DS-0026",
          "Title": "No HEALTHCHECK defined",
          "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
          "Message": "Add HEALTHCHECK instruction in your Dockerfile",
          "Namespace": "builtin.dockerfile.DS026",
          "Query": "data.builtin.dockerfile.DS026.deny",
          "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
          "References": [
            "https://blog.aquasec.com/docker-security-best-practices",
            "https://avd.aquasec.com/misconfig/ds026"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general"
          }
        }
      ]
    },
    {
      "Target": "node_modules/.pnpm/swagger2openapi@7.0.8/node_modules/swagger2openapi/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 25,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS002",
          "AVDID": "AVD-DS-0002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
          "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
          "Namespace": "builtin.dockerfile.DS002",
          "Query": "data.builtin.dockerfile.DS002.deny",
          "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds002"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general"
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS026",
          "AVDID": "AVD-DS-0026",
          "Title": "No HEALTHCHECK defined",
          "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
          "Message": "Add HEALTHCHECK instruction in your Dockerfile",
          "Namespace": "builtin.dockerfile.DS026",
          "Query": "data.builtin.dockerfile.DS026.deny",
          "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
          "References": [
            "https://blog.aquasec.com/docker-security-best-practices",
            "https://avd.aquasec.com/misconfig/ds026"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general"
          }
        }
      ]
    },
    {
      "Target": "smc_agent.Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 26,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get update \u0026\u0026 apt-get install -y     wget     curl     gnupg     \u0026\u0026 rm -rf /var/lib/apt/lists/*'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 8,
            "EndLine": 12,
            "Code": {
              "Lines": [
                {
                  "Number": 8,
                  "Content": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    wget \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    wget \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "    curl \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    curl \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    gnupg \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    gnupg \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'wget -qO - https://aquasec.github.io/trivy-repo/deb/public.key | apt-key add -     \u0026\u0026 echo \"deb https://aquasec.github.io/trivy-repo/deb generic main\" | tee -a /etc/apt/sources.list     \u0026\u0026 apt-get update     \u0026\u0026 apt-get install -y trivy     \u0026\u0026 rm -rf /var/lib/apt/lists/*'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "RUN wget -qO - https://aquasec.github.io/trivy-repo/deb/public.key | apt-key add - \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "RUN wget -qO - https://aquasec.github.io/trivy-repo/deb/public.key | apt-key add - \\",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    \u0026\u0026 echo \"deb https://aquasec.github.io/trivy-repo/deb generic main\" | tee -a /etc/apt/sources.list \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 echo \"deb https://aquasec.github.io/trivy-repo/deb generic main\" | tee -a /etc/apt/sources.list \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "    \u0026\u0026 apt-get update \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 apt-get update \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "    \u0026\u0026 apt-get install -y trivy \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 apt-get install -y trivy \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "stream_processor.Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 26,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get update \u0026\u0026 apt-get install -y     curl     \u0026\u0026 rm -rf /var/lib/apt/lists/*'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 31,
            "EndLine": 33,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    curl \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    curl \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get update \u0026\u0026 apt-get install -y     gcc     g++     libffi-dev     libssl-dev     \u0026\u0026 rm -rf /var/lib/apt/lists/*'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 8,
            "EndLine": 13,
            "Code": {
              "Lines": [
                {
                  "Number": 8,
                  "Content": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "RUN apt-get update \u0026\u0026 apt-get install -y \\",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    gcc \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    gcc \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "    g++ \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    g++ \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    libffi-dev \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    libffi-dev \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "    libssl-dev \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    libssl-dev \\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u0026\u0026 rm -rf /var/lib/apt/lists/*",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 57,
        "Failures": 0
      }
    },
    {
      "Target": "terraform/modules/vpc/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0017",
          "AVDID": "AVD-AWS-0017",
          "Title": "CloudWatch log groups should be encrypted using CMK",
          "Description": "CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.\n",
          "Message": "Log group is not encrypted.",
          "Namespace": "builtin.aws.cloudwatch.aws0017",
          "Query": "data.builtin.aws.cloudwatch.aws0017.deny",
          "Resolution": "Enable CMK encryption of CloudWatch Log Groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0017",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0017"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.vpc",
            "Provider": "AWS",
            "Service": "cloudwatch",
            "StartLine": 217,
            "EndLine": 224,
            "Code": {
              "Lines": [
                {
                  "Number": 217,
                  "Content": "resource \"aws_cloudwatch_log_group\" \"flow_log\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudwatch_log_group\"\u001b[0m \u001b[38;5;37m\"flow_log\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 218,
                  "Content": "  count = var.enable_flow_log \u0026\u0026 var.create_flow_log_cloudwatch_log_group ? 1 : 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;33mvar\u001b[0m.enable_flow_log \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;33mvar\u001b[0m.create_flow_log_cloudwatch_log_group \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 219,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 220,
                  "Content": "  name              = \"/aws/vpc/flowlogs/${var.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m              = \u001b[38;5;37m\"/aws/vpc/flowlogs/\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 221,
                  "Content": "  retention_in_days = 30",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mretention_in_days\u001b[0m = \u001b[38;5;37m30",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 222,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 223,
                  "Content": "  tags = var.tags",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = \u001b[38;5;33mvar\u001b[0m.tags",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 224,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vpc",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 93,
                  "EndLine": 115
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.vpc",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 40,
            "EndLine": 40,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_subnet\" \"public\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public[0]",
                "Filename": "terraform/modules/vpc/main.tf",
                "Location": {
                  "StartLine": 34,
                  "EndLine": 48
                }
              },
              {
                "Resource": "module.vpc",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 93,
                  "EndLine": 115
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.vpc",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 40,
            "EndLine": 40,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_subnet\" \"public\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public[1]",
                "Filename": "terraform/modules/vpc/main.tf",
                "Location": {
                  "StartLine": 34,
                  "EndLine": 48
                }
              },
              {
                "Resource": "module.vpc",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 93,
                  "EndLine": 115
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.vpc",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 40,
            "EndLine": 40,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_subnet\" \"public\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public[2]",
                "Filename": "terraform/modules/vpc/main.tf",
                "Location": {
                  "StartLine": 34,
                  "EndLine": 48
                }
              },
              {
                "Resource": "module.vpc",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 93,
                  "EndLine": 115
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": ".env",
      "Class": "secret",
      "Secrets": [
        {
          "RuleID": "jwt-token",
          "Category": "JWT",
          "Severity": "MEDIUM",
          "Title": "JWT token",
          "StartLine": 3,
          "EndLine": 3,
          "Code": {
            "Lines": [
              {
                "Number": 1,
                "Content": "# Supabase Configuration",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "# Supabase Configuration",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 2,
                "Content": "VITE_SUPABASE_URL=https://fqhuoszrysapxrvyaqao.supabase.co",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "VITE_SUPABASE_URL=https://fqhuoszrysapxrvyaqao.supabase.co",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 3,
                "Content": "VITE_SUPABASE_ANON_KEY=****************************************************************************************************************************************************************************************************************",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "VITE_SUPABASE_ANON_KEY=****************************************************************************************************************************************************************************************************************",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 4,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "VITE_SUPABASE_ANON_KEY=****************************************************************************************************************************************************************************************************************"
        },
        {
          "RuleID": "jwt-token",
          "Category": "JWT",
          "Severity": "MEDIUM",
          "Title": "JWT token",
          "StartLine": 6,
          "EndLine": 6,
          "Code": {
            "Lines": [
              {
                "Number": 4,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 5,
                "Content": "# Backend Supabase Configuration (Server-side only)",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "# Backend Supabase Configuration (Server-side only)",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 6,
                "Content": "SUPABASE_SERVICE_ROLE_KEY=***************************************************************************************************************************************************************************************************************************",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_SERVICE_ROLE_KEY=***************************************************************************************************************************************************************************************************************************",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 7,
                "Content": "SUPABASE_URL=https://fqhuoszrysapxrvyaqao.supabase.co",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_URL=https://fqhuoszrysapxrvyaqao.supabase.co",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "SUPABASE_SERVICE_ROLE_KEY=***************************************************************************************************************************************************************************************************************************"
        }
      ]
    },
    {
      "Target": "api/.env",
      "Class": "secret",
      "Secrets": [
        {
          "RuleID": "jwt-token",
          "Category": "JWT",
          "Severity": "MEDIUM",
          "Title": "JWT token",
          "StartLine": 3,
          "EndLine": 3,
          "Code": {
            "Lines": [
              {
                "Number": 1,
                "Content": "# Supabase Configuration",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "# Supabase Configuration",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 2,
                "Content": "SUPABASE_URL=https://fqhuoszrysapxrvyaqao.supabase.co",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_URL=https://fqhuoszrysapxrvyaqao.supabase.co",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 3,
                "Content": "SUPABASE_SERVICE_ROLE_KEY=***************************************************************************************************************************************************************************************************************************",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_SERVICE_ROLE_KEY=***************************************************************************************************************************************************************************************************************************",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 4,
                "Content": "SUPABASE_ANON_KEY=**********************************************************************************",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_ANON_KEY=**********************************************************************************",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "SUPABASE_SERVICE_ROLE_KEY=***************************************************************************************************************************************************************************************************************************"
        },
        {
          "RuleID": "jwt-token",
          "Category": "JWT",
          "Severity": "MEDIUM",
          "Title": "JWT token",
          "StartLine": 4,
          "EndLine": 4,
          "Code": {
            "Lines": [
              {
                "Number": 2,
                "Content": "SUPABASE_URL=https://fqhuoszrysapxrvyaqao.supabase.co",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_URL=https://fqhuoszrysapxrvyaqao.supabase.co",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 3,
                "Content": "SUPABASE_SERVICE_ROLE_KEY=**************************************************************************",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_SERVICE_ROLE_KEY=**************************************************************************",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 4,
                "Content": "SUPABASE_ANON_KEY=****************************************************************************************************************************************************************************************************************",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_ANON_KEY=****************************************************************************************************************************************************************************************************************",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 5,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "SUPABASE_ANON_KEY=****************************************************************************************************************************************************************************************************************"
        }
      ]
    },
    {
      "Target": "api/supabase.ts",
      "Class": "secret",
      "Secrets": [
        {
          "RuleID": "jwt-token",
          "Category": "JWT",
          "Severity": "MEDIUM",
          "Title": "JWT token",
          "StartLine": 30,
          "EndLine": 30,
          "Code": {
            "Lines": [
              {
                "Number": 28,
                "Content": "    // Fallback to environment variables",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    // Fallback to environment variables",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    const supabaseUrl = process.env.SUPABASE_URL || 'https://fqhuoszrysapxrvyaqao.supabase.co';",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    const supabaseUrl = process.env.SUPABASE_URL || 'https://fqhuoszrysapxrvyaqao.supabase.co';",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "SUPABASE_SERVICE_ROLE_KEY || '***************************************************************************************************************************************************************************************************************************';",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "SUPABASE_SERVICE_ROLE_KEY || '***************************************************************************************************************************************************************************************************************************';",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 31,
                "Content": "    ",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    ",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "SUPABASE_SERVICE_ROLE_KEY || '***************************************************************************************************************************************************************************************************************************';"
        }
      ]
    },
    {
      "Target": "dist/assets/index-CvGfYhkJ.js",
      "Class": "secret",
      "Secrets": [
        {
          "RuleID": "jwt-token",
          "Category": "JWT",
          "Severity": "MEDIUM",
          "Title": "JWT token",
          "StartLine": 715,
          "EndLine": 715,
          "Code": {
            "Lines": [
              {
                "Number": 713,
                "Content": "  });`;class z4{constructor(n,o){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  });`;class z4{constructor(n,o){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 714,
                "Content": "\\r=`.split(\"\"),m5=(()=\u003e{const i=new Array(128);for(let n=0;n\u003ci.length;n+=1)i[n]=-1;for(let n=0;n\u003cRb.",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\\r=`.split(\"\"),m5=(()=\u003e{const i=new Array(128);for(let n=0;n\u003ci.length;n+=1)i[n]=-1;for(let n=0;n\u003cRb.",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 715,
                "Content": "ysapxrvyaqao.supabase.co\",rj=\"****************************************************************************************************************************************************************************************************************\",Be=Z5(tj,rj,{auth:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "ysapxrvyaqao.supabase.co\",rj=\"****************************************************************************************************************************************************************************************************************\",Be=Z5(tj,rj,{auth:",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 716,
                "Content": "`,n)}function Tj(){if(!Tx())return new Promise(n=\u003en(!1));const i=window.PublicKeyCredential;return i",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "`,n)}function Tj(){if(!Tx())return new Promise(n=\u003en(!1));const i=window.PublicKeyCredential;return i",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "ysapxrvyaqao.supabase.co\",rj=\"****************************************************************************************************************************************************************************************************************\",Be=Z5(tj,rj,{auth:"
        }
      ]
    },
    {
      "Target": "src/lib/supabase.ts",
      "Class": "secret",
      "Secrets": [
        {
          "RuleID": "jwt-token",
          "Category": "JWT",
          "Severity": "MEDIUM",
          "Title": "JWT token",
          "StartLine": 5,
          "EndLine": 5,
          "Code": {
            "Lines": [
              {
                "Number": 3,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 4,
                "Content": "const supabaseUrl = import.meta.env.VITE_SUPABASE_URL || 'https://fqhuoszrysapxrvyaqao.supabase.co';",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "const supabaseUrl = import.meta.env.VITE_SUPABASE_URL || 'https://fqhuoszrysapxrvyaqao.supabase.co';",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 5,
                "Content": "nv.VITE_SUPABASE_ANON_KEY || '****************************************************************************************************************************************************************************************************************';",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "nv.VITE_SUPABASE_ANON_KEY || '****************************************************************************************************************************************************************************************************************';",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 6,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "nv.VITE_SUPABASE_ANON_KEY || '****************************************************************************************************************************************************************************************************************';"
        }
      ]
    },
    {
      "Target": "src/supabase.ts",
      "Class": "secret",
      "Secrets": [
        {
          "RuleID": "jwt-token",
          "Category": "JWT",
          "Severity": "MEDIUM",
          "Title": "JWT token",
          "StartLine": 5,
          "EndLine": 5,
          "Code": {
            "Lines": [
              {
                "Number": 3,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 4,
                "Content": "const supabaseUrl = import.meta.env.VITE_SUPABASE_URL || 'https://fqhuoszrysapxrvyaqao.supabase.co';",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "const supabaseUrl = import.meta.env.VITE_SUPABASE_URL || 'https://fqhuoszrysapxrvyaqao.supabase.co';",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 5,
                "Content": "nv.VITE_SUPABASE_ANON_KEY || '****************************************************************************************************************************************************************************************************************';",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "nv.VITE_SUPABASE_ANON_KEY || '****************************************************************************************************************************************************************************************************************';",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 6,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Match": "nv.VITE_SUPABASE_ANON_KEY || '****************************************************************************************************************************************************************************************************************';"
        }
      ]
    }
  ]
}

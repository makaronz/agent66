# Trading App v2 - Import Structure & Module Organization

## ğŸ—ï¸ **Application Stack**

- **Backend**: Express + TypeScript + MongoDB (port 5001)
- **Frontend**: React 18.2 + Redux Toolkit + TypeScript (port 3000)
- **Full TypeScript codebase** with ES modules

**Note**: Legacy Python/Rust system archived in `app_old/`

---

## ğŸš¨ **Critical Import Rules**

### **Backend (Express + TypeScript)**

Use **standard ES module imports** with relative paths:

```typescript
// âœ… CORRECT backend imports

// External packages
import express, { Express, Request, Response } from 'express';
import mongoose from 'mongoose';
import bcrypt from 'bcryptjs';
import jwt from 'jsonwebtoken';
import { z } from 'zod';

// Local modules (relative imports)
import { authGuard } from './middleware/auth';
import { validateRequest } from './middleware/validation';
import { User } from './models/User';
import { Post } from './models/Post';
import authRoutes from './routes/auth';
import postRoutes from './routes/posts';
```

**Key Rules:**
- No `@/` alias in backend
- Use relative paths: `./`, `../`
- No file extensions in imports
- Named exports use `{ }` syntax

### **Frontend (React + TypeScript)**

Use **relative imports** for all local files:

```typescript
// âœ… CORRECT frontend imports

// External packages
import React from 'react';
import { BrowserRouter, Routes, Route, Link } from 'react-router-dom';
import { Provider, useDispatch, useSelector } from 'react-redux';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';
import toast from 'react-hot-toast';

// Local modules (relative imports)
import { store } from './store/store';
import { loginUser, registerUser } from './store/slices/authSlice';
import type { AppDispatch, RootState } from './store/store';
import LoginForm from './components/LoginForm';
import RegisterForm from './components/RegisterForm';
import Dashboard from './components/Dashboard';
import PrivateRoute from './components/PrivateRoute';
```

**Key Rules:**
- No `@/` alias configured (could be added later)
- Use relative paths: `./components/`, `../store/`
- No file extensions (.tsx) in imports
- Type imports use `type` keyword when possible

## ğŸ“ **Module Organization**

### **Backend Structure**
```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ server.ts             # Express server + MongoDB setup
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ auth.ts           # POST /auth/register, /auth/login
â”‚   â”‚   â”œâ”€â”€ posts.ts          # CRUD operations for posts
â”‚   â”‚   â””â”€â”€ weather.ts        # GET /weather?city=X (requires API key)
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ User.ts           # Mongoose User schema (email, password hash)
â”‚   â”‚   â””â”€â”€ Post.ts           # Mongoose Post schema (title, content, author)
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ auth.ts           # JWT authentication guard
â”‚   â”‚   â””â”€â”€ validation.ts     # Zod request validation
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ swagger.ts        # OpenAPI/Swagger configuration
â”‚   â””â”€â”€ tests/
â”‚       â””â”€â”€ user.test.ts      # Jest tests
â”œâ”€â”€ .env.example              # Environment template
â”œâ”€â”€ package.json              # Dependencies + scripts (tsx, nodemon)
â”œâ”€â”€ tsconfig.json             # TypeScript config (ES2022)
â””â”€â”€ jest.config.js            # Jest configuration
```

### **Frontend Structure**
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.tsx             # React DOM entry point
â”‚   â”œâ”€â”€ App.tsx               # Router + Provider setup
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx     # Login with Zod validation
â”‚   â”‚   â”œâ”€â”€ RegisterForm.tsx  # Registration with password confirm
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx     # Main dashboard view
â”‚   â”‚   â”œâ”€â”€ AddDataForm.tsx   # Data entry form
â”‚   â”‚   â””â”€â”€ PrivateRoute.tsx  # Protected route wrapper
â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â”œâ”€â”€ store.ts          # Redux store configuration
â”‚   â”‚   â””â”€â”€ slices/
â”‚   â”‚       â”œâ”€â”€ authSlice.ts  # Auth state (token, user, loading)
â”‚   â”‚       â””â”€â”€ postSlice.ts  # Posts state management
â”‚   â”œâ”€â”€ index.css             # Tailwind CSS imports
â”‚   â””â”€â”€ setupTests.ts         # Jest + React Testing Library
â”œâ”€â”€ public/
â”‚   â””â”€â”€ index.html            # HTML template
â”œâ”€â”€ .env.example              # Environment template
â”œâ”€â”€ package.json              # Dependencies (React 18, Redux Toolkit)
â”œâ”€â”€ tailwind.config.js        # Tailwind configuration
â””â”€â”€ tsconfig.json             # TypeScript config (JSX support)
```

## ğŸ”§ **Common Import Issues & Fixes**

### **Issue 1: Module Not Found (TypeScript)**
**Error**: `Cannot find module './components/LoginForm'`
**Cause**: Incorrect relative path or missing file
**Solution**: 
```typescript
// âœ… Check relative path is correct
import LoginForm from './components/LoginForm';  // same directory
import { store } from '../store/store';          // parent directory
```

### **Issue 2: Named vs Default Exports**
**Error**: `'LoginForm' is not exported from './components/LoginForm'`
**Cause**: Mixing named and default exports
**Solution**:
```typescript
// âœ… Default export (most components)
export default LoginForm;
import LoginForm from './components/LoginForm';

// âœ… Named export (actions, types)
export const loginUser = createAsyncThunk(...);
import { loginUser } from './store/slices/authSlice';
```

### **Issue 3: Type Import Optimization**
**Error**: TypeScript performance issues with large imports
**Solution**: Use `type` keyword for type-only imports
```typescript
// âœ… Optimized type imports
import type { AppDispatch, RootState } from './store/store';
import type { LoginFormInputs } from './types';
```

## ğŸ§ª **Testing Import Resolution**

### **Test Current Application**
```bash
# Backend TypeScript compilation
cd backend
npm run build

# Frontend TypeScript compilation  
cd frontend
npm test -- --passWithNoTests

# Backend tests
cd backend && npm test

# Frontend tests
cd frontend && npm test
```

### **Verify Import Changes Work**
```bash
# After adding imports, verify compilation
cd backend && npm run build
cd frontend && npm test -- --passWithNoTests

# Check for import errors in console
npm start  # Watch for import errors in output
```

## ğŸ“‹ **Import Checklist**

When adding new TypeScript imports:

1. **External or local?** - External uses package name, local uses relative path
2. **Named or default export?** - Check how the module exports
3. **Type-only import?** - Use `import type { }` for types
4. **Correct relative path?** - `./` same dir, `../` parent dir
5. **Test compilation** - Run `npm run build` to verify

## âš ï¸ **Import Best Practices**

### **Backend**
1. âœ… Use ES module `import` syntax (not `require`)
2. âœ… Relative paths for local modules
3. âœ… Named imports for middleware, types
4. âœ… Default imports for routes, models
5. âœ… No file extensions in import paths

### **Frontend**
1. âœ… Relative imports for all local files
2. âœ… Default imports for components
3. âœ… Named imports for hooks, actions, types
4. âœ… Group imports: external, then local
5. âœ… Use `type` keyword for type-only imports

### **Common Patterns**
```typescript
// âœ… Import grouping example
// 1. External packages
import React from 'react';
import { useDispatch } from 'react-redux';
import { z } from 'zod';

// 2. Local modules  
import { loginUser } from '../store/slices/authSlice';
import type { AppDispatch } from '../store/store';
import LoginForm from './components/LoginForm';
```

---

**Remember**: This is a full TypeScript application. No Python imports in active codebase (see `app_old/` for legacy Python reference).
description:
globs:
alwaysApply: true
---

import{r as e,j as s,au as t,J as a,aj as i,aq as r,Y as n}from"./react-m-WA-DAu.js";import{s as o}from"./index-BH92hES8.js";import"./vendor-CCzY5YmT.js";import"./utils-qIfB5D_q.js";const l=({enabled:l,onStatusChange:c})=>{const[d,x]=e.useState(""),[m,h]=e.useState(""),[u,b]=e.useState(!1),[g,p]=e.useState("initial"),[f,y]=e.useState("");return"setup"===g?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx(t,{className:"h-12 w-12 text-blue-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Set up SMS Verification"}),s.jsx("p",{className:"text-gray-600",children:"Enter your phone number to receive verification codes"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),s.jsx("input",{type:"tel",value:d,onChange:e=>{const s=(e=>{const s=e.replace(/\D/g,"");return s.length<=10?s.length>=6?`+1 (${s.slice(0,3)}) ${s.slice(3,6)}-${s.slice(6)}`:s.length>=3?`+1 (${s.slice(0,3)}) ${s.slice(3)}`:`+1 (${s}`:`+1 (${s.slice(0,3)}) ${s.slice(3,6)}-${s.slice(6,10)}`})(e.target.value);x(s)},placeholder:"+1 (555) 123-4567",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"US phone numbers only"})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(a,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Important:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[s.jsx("li",{children:"Standard SMS rates may apply"}),s.jsx("li",{children:"Keep your phone accessible during login"}),s.jsx("li",{children:"Codes expire after 10 minutes"})]})]})]})}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>{p("initial"),x("")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:async()=>{const e=d.replace(/\D/g,"");if(10===e.length){b(!0);try{const{data:{session:s}}=await o.auth.getSession();if(!s)return void n.error("Please log in to set up SMS verification");const t=await fetch("/api/sms/setup",{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:`+1${e}`})});if(t.ok){const e=await t.json();y(e.maskedPhone),p("verify"),n.success("Verification code sent to your phone")}else{const e=await t.json();n.error(e.message||"Failed to send verification code")}}catch(s){n.error("Error sending verification code")}finally{b(!1)}}else n.error("Please enter a valid 10-digit phone number")},disabled:u||10!==d.replace(/\D/g,"").length,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?"Sending...":"Send Code"})]})]})]}):"verify"===g?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx(i,{className:"h-12 w-12 text-blue-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Verify Your Phone"}),s.jsxs("p",{className:"text-gray-600",children:["We sent a 6-digit code to ",f]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter verification code:"}),s.jsx("input",{type:"text",value:m,onChange:e=>{const s=e.target.value.replace(/\D/g,"").slice(0,6);h(s)},placeholder:"000000",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-lg font-mono tracking-widest",maxLength:6})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:async()=>{b(!0);try{const{data:{session:e}}=await o.auth.getSession();if(!e)return void n.error("Please log in to resend code");const s=await fetch("/api/sms/resend",{method:"POST",headers:{Authorization:`Bearer ${e.access_token}`}});if(s.ok)n.success("New verification code sent");else{const e=await s.json();n.error(e.message||"Failed to resend code")}}catch(e){n.error("Error resending verification code")}finally{b(!1)}},disabled:u,className:"text-sm text-blue-600 hover:text-blue-800 disabled:opacity-50",children:"Didn't receive a code? Resend"})}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>{p("initial"),x(""),h(""),y("")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:async()=>{if(m&&6===m.length){b(!0);try{const{data:{session:e}}=await o.auth.getSession();if(!e)return void n.error("Please log in to verify SMS");const s=await fetch("/api/sms/verify-setup",{method:"POST",headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({code:m})});if(s.ok)n.success("SMS verification enabled successfully!"),p("initial"),x(""),h(""),y(""),c();else{const e=await s.json();n.error(e.message||"Invalid verification code")}}catch(e){n.error("Error verifying SMS code")}finally{b(!1)}}else n.error("Please enter a valid 6-digit code")},disabled:u||6!==m.length,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?"Verifying...":"Verify & Enable"})]})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx(i,{className:"h-12 w-12 text-blue-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"SMS Verification"}),s.jsx("p",{className:"text-gray-600",children:"Receive verification codes via text message"})]}),l?s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(r,{className:"h-5 w-5 text-green-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-green-800",children:"SMS Verification Enabled"}),s.jsx("p",{className:"text-sm text-green-700",children:"You'll receive codes on your registered phone"})]})]})}):s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(a,{className:"h-5 w-5 text-yellow-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"SMS Verification Disabled"}),s.jsx("p",{className:"text-sm text-yellow-700",children:"Add your phone number for SMS-based authentication"})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"How SMS verification works:"}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("li",{children:"• Enter your phone number once during setup"}),s.jsx("li",{children:"• Receive 6-digit codes via text message"}),s.jsx("li",{children:"• Enter the code when logging in"}),s.jsx("li",{children:"• Works on any phone that can receive SMS"})]})]}),s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(a,{className:"h-5 w-5 text-amber-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-amber-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Security Note:"}),s.jsx("p",{children:"SMS is less secure than authenticator apps or hardware keys. Consider using those methods for better protection."})]})]})}),s.jsx("div",{className:"flex space-x-3",children:l?s.jsx("button",{onClick:async()=>{if(confirm("Are you sure you want to disable SMS verification? This will reduce your account security.")){b(!0);try{const{data:{session:e}}=await o.auth.getSession();if(!e)return void n.error("Please log in to disable SMS verification");const s=await fetch("/api/sms/disable",{method:"POST",headers:{Authorization:`Bearer ${e.access_token}`}});if(s.ok)n.success("SMS verification disabled"),c();else{const e=await s.json();n.error(e.message||"Failed to disable SMS verification")}}catch(e){n.error("Error disabling SMS verification")}finally{b(!1)}}},disabled:u,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?"Disabling...":"Disable SMS"}):s.jsx("button",{onClick:()=>p("setup"),disabled:u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Set up SMS Verification"})})]})]})};export{l as default};

import{r as e,j as s,aq as a,G as c,ar as t,$ as r,a3 as n,Y as l}from"./react-m-WA-DAu.js";import{s as o}from"./index-BH92hES8.js";import"./vendor-CCzY5YmT.js";import"./utils-qIfB5D_q.js";const i=({enabled:i,remainingCodes:d,onStatusChange:m})=>{const[x,h]=e.useState([]),[u,p]=e.useState(!1),[j,b]=e.useState(!1),[g,y]=e.useState(null);return j&&x.length>0?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx(a,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Your Backup Codes"}),s.jsx("p",{className:"text-gray-600",children:"Save these codes in a secure location. Each can only be used once."})]}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(c,{className:"h-5 w-5 text-red-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Critical Security Information:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[s.jsx("li",{children:"These codes will only be shown once"}),s.jsx("li",{children:"Store them in a password manager or secure location"}),s.jsx("li",{children:"Each code can only be used once"}),s.jsx("li",{children:"Don't share these codes with anyone"})]})]})]})}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:x.map((e,c)=>s.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border",children:[s.jsx("span",{className:"font-mono text-sm",children:e}),s.jsx("button",{onClick:()=>(async(e,s)=>{await navigator.clipboard.writeText(e),y(s),l.success("Code copied to clipboard"),setTimeout(()=>y(null),2e3)})(e,c),className:"ml-2 p-1 text-gray-500 hover:text-gray-700 transition-colors",title:"Copy code",children:g===c?s.jsx(a,{className:"h-4 w-4 text-green-600"}):s.jsx(t,{className:"h-4 w-4"})})]},c))})}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs("button",{onClick:async()=>{const e=x.join("\n");await navigator.clipboard.writeText(e),l.success("All codes copied to clipboard")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors flex items-center justify-center space-x-2",children:[s.jsx(t,{className:"h-4 w-4"}),s.jsx("span",{children:"Copy All"})]}),s.jsxs("button",{onClick:()=>{const e=["SMC Trading Agent - Backup Recovery Codes","==========================================","","IMPORTANT: Store these codes in a safe place!","Each code can only be used once.","","Generated on: "+(new Date).toLocaleString(),"",...x.map((e,s)=>`${s+1}. ${e}`),"","Keep these codes secure and accessible.","You will need them if you lose access to your other MFA methods."].join("\n"),s=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(s),c=document.createElement("a");c.href=a,c.download=`smc-backup-codes-${(new Date).toISOString().split("T")[0]}.txt`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(a),l.success("Backup codes downloaded")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors flex items-center justify-center space-x-2",children:[s.jsx(r,{className:"h-4 w-4"}),s.jsx("span",{children:"Download"})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{className:"font-medium mb-2",children:"How to use backup codes:"}),s.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[s.jsx("li",{children:'When prompted for MFA during login, select "Use backup code"'}),s.jsx("li",{children:"Enter one of these codes exactly as shown"}),s.jsx("li",{children:"The code will be consumed and cannot be used again"}),s.jsx("li",{children:"Generate new codes when you're running low"})]})]})}),s.jsx("button",{onClick:()=>{b(!1),h([])},className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"I've Saved These Codes Securely"})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx(n,{className:"h-12 w-12 text-blue-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Backup Recovery Codes"}),s.jsx("p",{className:"text-gray-600",children:"One-time use codes for account recovery when other MFA methods aren't available"})]}),i?s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(a,{className:"h-5 w-5 text-green-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-green-800",children:"Backup Codes Generated"}),s.jsxs("p",{className:"text-sm text-green-700",children:["You have ",d," unused backup code",1!==d?"s":""," remaining"]})]})]})}):s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(c,{className:"h-5 w-5 text-yellow-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"No Backup Codes Generated"}),s.jsx("p",{className:"text-sm text-yellow-700",children:"Generate backup codes for account recovery"})]})]})}),d<=2&&d>0&&s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(c,{className:"h-5 w-5 text-amber-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-amber-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Running Low on Backup Codes"}),s.jsxs("p",{children:["You only have ",d," backup code",1!==d?"s":""," remaining. Consider generating new ones."]})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"What are backup codes?"}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("li",{children:"• One-time use codes for emergency access"}),s.jsx("li",{children:"• Use when you can't access your phone or security key"}),s.jsx("li",{children:"• Each code works only once"}),s.jsx("li",{children:"• Store them securely offline"})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(c,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Security Best Practices:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[s.jsx("li",{children:"Store codes in a password manager"}),s.jsx("li",{children:"Keep a printed copy in a secure location"}),s.jsx("li",{children:"Don't store codes on the same device you use for login"}),s.jsx("li",{children:"Generate new codes if you suspect they're compromised"})]})]})]})}),s.jsxs("button",{onClick:async()=>{if(!i||confirm("Generating new backup codes will invalidate your existing codes. Continue?")){p(!0);try{const{data:{session:e}}=await o.auth.getSession();if(!e)return void l.error("Please log in to generate backup codes");const s=await fetch("/api/mfa/backup-codes/generate",{method:"POST",headers:{Authorization:`Bearer ${e.access_token}`}});if(s.ok){const e=await s.json();h(e.codes),b(!0),l.success("Backup codes generated successfully!"),m()}else{const e=await s.json();l.error(e.message||"Failed to generate backup codes")}}catch(e){l.error("Error generating backup codes")}finally{p(!1)}}},disabled:u,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[s.jsx(n,{className:"h-4 w-4 "+(u?"animate-spin":"")}),s.jsx("span",{children:u?"Generating...":i?"Generate New Codes":"Generate Backup Codes"})]})]})]})};export{i as default};

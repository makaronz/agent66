const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TOTPSetup-BRVBPQva.js","assets/react-m-WA-DAu.js","assets/vendor-CCzY5YmT.js","assets/index-BH92hES8.js","assets/utils-qIfB5D_q.js","assets/index-BNfOek6g.css","assets/LazyImage-Degy4hjP.js","assets/WebAuthnSetup-CUsMXamI.js","assets/auth-4gRa0qqt.js","assets/SMSSetup-9-2sCdzP.js","assets/BackupCodes-BKqugjcp.js","assets/MFAEducation-CVI-gUmi.js","assets/SecurityDashboard-BIOza6X4.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./vendor-CCzY5YmT.js";import{r as s,Y as a,j as t,b as r,G as n,aj as l,I as d,K as i,F as c,ak as o,A as m,B as x}from"./react-m-WA-DAu.js";import{s as b}from"./index-BH92hES8.js";import"./utils-qIfB5D_q.js";const h=s.lazy(()=>e(()=>import("./TOTPSetup-BRVBPQva.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),u=s.lazy(()=>e(()=>import("./WebAuthnSetup-CUsMXamI.js"),__vite__mapDeps([7,1,2,3,4,5,8]))),g=s.lazy(()=>e(()=>import("./SMSSetup-9-2sCdzP.js"),__vite__mapDeps([9,1,2,3,4,5]))),j=s.lazy(()=>e(()=>import("./BackupCodes-BKqugjcp.js"),__vite__mapDeps([10,1,2,3,4,5]))),p=s.lazy(()=>e(()=>import("./MFAEducation-CVI-gUmi.js"),__vite__mapDeps([11,1,2]))),y=s.lazy(()=>e(()=>import("./SecurityDashboard-BIOza6X4.js"),__vite__mapDeps([12,1,2,3,4,5]))),N=()=>{const[e,N]=s.useState(null),[_,f]=s.useState(!0),[w,v]=s.useState("totp");s.useEffect(()=>{S()},[]);const S=async()=>{try{const{data:{session:e}}=await b.auth.getSession();if(!e)return void a.error("Please log in to access MFA settings");const s=await fetch("/api/mfa/status",{headers:{Authorization:`Bearer ${e.access_token}`}});if(s.ok){const e=await s.json();N(e)}else a.error("Failed to fetch MFA status")}catch(e){a.error("Error loading MFA settings")}finally{f(!1)}},A=()=>{S()};if(_)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})});const k=e?[e.totp_enabled&&"Authenticator App",e.webauthn_enabled&&"Hardware Key",e.sms_enabled&&"SMS",e.backup_codes_enabled&&"Backup Codes"].filter(Boolean).length:0,E=0===k?"Low":1===k?"Medium":"High",C=0===k?"text-red-600":1===k?"text-yellow-600":"text-green-600";return t.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:t.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(r,{className:"h-8 w-8 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Multi-Factor Authentication"}),t.jsx("p",{className:"text-gray-600",children:"Secure your account with additional verification methods"})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Security Level"}),t.jsx("div",{className:`text-lg font-semibold ${C}`,children:E}),t.jsxs("div",{className:"text-xs text-gray-400",children:[k," method",1!==k?"s":""," enabled"]})]})]})}),0===k&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx(n,{className:"h-5 w-5 text-red-600 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Security Warning"}),t.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Your account is not protected by multi-factor authentication. Enable at least one MFA method to secure your trading account."})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 "+(e?.totp_enabled?"border-green-200 bg-green-50":"border-gray-200"),children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(l,{className:"h-6 w-6 text-blue-600"}),e?.totp_enabled&&t.jsx(d,{className:"h-5 w-5 text-green-600"})]}),t.jsx("h3",{className:"font-medium text-gray-900 mt-2",children:"Authenticator App"}),t.jsx("p",{className:"text-sm text-gray-600",children:"TOTP codes from your phone"})]}),t.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 "+(e?.webauthn_enabled?"border-green-200 bg-green-50":"border-gray-200"),children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(i,{className:"h-6 w-6 text-blue-600"}),e?.webauthn_enabled&&t.jsx(d,{className:"h-5 w-5 text-green-600"})]}),t.jsx("h3",{className:"font-medium text-gray-900 mt-2",children:"Hardware Key"}),t.jsx("p",{className:"text-sm text-gray-600",children:"WebAuthn/FIDO2 devices"})]}),t.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 "+(e?.sms_enabled?"border-green-200 bg-green-50":"border-gray-200"),children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(l,{className:"h-6 w-6 text-blue-600"}),e?.sms_enabled&&t.jsx(d,{className:"h-5 w-5 text-green-600"})]}),t.jsx("h3",{className:"font-medium text-gray-900 mt-2",children:"SMS Verification"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Codes sent to your phone"})]}),t.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 "+(e?.backup_codes_enabled?"border-green-200 bg-green-50":"border-gray-200"),children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(c,{className:"h-6 w-6 text-blue-600"}),e?.backup_codes_enabled&&t.jsx(d,{className:"h-5 w-5 text-green-600"})]}),t.jsx("h3",{className:"font-medium text-gray-900 mt-2",children:"Backup Codes"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[e?.remainingBackupCodes||0," codes remaining"]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[t.jsx("div",{className:"border-b border-gray-200",children:t.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:[{id:"totp",label:"Authenticator App",icon:l},{id:"webauthn",label:"Hardware Key",icon:i},{id:"sms",label:"SMS",icon:o},{id:"backup",label:"Backup Codes",icon:c},{id:"security",label:"Security Dashboard",icon:m},{id:"education",label:"Learn More",icon:x}].map(({id:e,label:s,icon:a})=>t.jsxs("button",{onClick:()=>v(e),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(w===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[t.jsx(a,{className:"h-4 w-4"}),t.jsx("span",{children:s})]},e))})}),t.jsx("div",{className:"p-6",children:t.jsxs(s.Suspense,{fallback:t.jsxs("div",{className:"flex items-center justify-center py-8",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),t.jsx("span",{className:"ml-2 text-gray-600",children:"Loading..."})]}),children:["totp"===w&&t.jsx(h,{enabled:e?.totp_enabled||!1,onStatusChange:A}),"webauthn"===w&&t.jsx(u,{enabled:e?.webauthn_enabled||!1,onStatusChange:A}),"sms"===w&&t.jsx(g,{enabled:e?.sms_enabled||!1,onStatusChange:A}),"backup"===w&&t.jsx(j,{enabled:e?.backup_codes_enabled||!1,remainingCodes:e?.remainingBackupCodes||0,onStatusChange:A}),"security"===w&&t.jsx(y,{}),"education"===w&&t.jsx(p,{})]})})]})]})})};export{N as default};

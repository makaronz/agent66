const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TradingViewChart-DKbBXSVx.js","assets/react-m-WA-DAu.js","assets/vendor-CCzY5YmT.js","assets/LiveSignals-BYBenura.js","assets/RealtimeStatus-DD3TxqFc.js","assets/index-BH92hES8.js","assets/utils-qIfB5D_q.js","assets/index-BNfOek6g.css","assets/SEOHead-CWeMjKrp.js","assets/LiveTrades-C7U-HVhN.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{_ as s}from"./vendor-CCzY5YmT.js";import{v as a,c as n,i,w as r,r as c,x as o,j as l,y as h,D as d,T as m,z as u,A as p,C as g,G as y,I as f,J as w}from"./react-m-WA-DAu.js";import{u as b,r as x,q as v,h as S,d as k,c as T}from"./index-BH92hES8.js";import{S as j}from"./SEOHead-CWeMjKrp.js";class N{constructor(){t(this,"baseUrl","https://api.binance.com/api/v3"),t(this,"wsUrl","wss://stream.binance.com:9443/ws"),t(this,"alternativeWsUrl","wss://data-stream.binance.vision/ws"),t(this,"websockets",new Map),t(this,"maxReconnectAttempts",5),t(this,"reconnectDelay",1e3),t(this,"pingInterval",3e4),t(this,"pongTimeout",1e4),t(this,"connectionTimeout",864e5),t(this,"rateLimits",new Map),t(this,"defaultRateLimit",{requests:1200,interval:6e4,lastReset:Date.now()}),t(this,"exchangeInfoCache",null),t(this,"exchangeInfoCacheTime",0),t(this,"exchangeInfoCacheTTL",864e5),t(this,"currentListenKey",null),t(this,"listenKeyRefreshInterval",null),t(this,"userDataStreamConnection",null),t(this,"connectionDebounceMap",new Map),t(this,"connectionStateMap",new Map)}async checkRateLimit(e="default"){const t=Date.now(),s=this.rateLimits.get(e)||this.defaultRateLimit;if(t-s.lastReset>=s.interval&&(s.requests=0,s.lastReset=t,this.rateLimits.set(e,s)),s.requests>=(this.rateLimits.get(e)?.requests||this.defaultRateLimit.requests)){const e=s.interval-(t-s.lastReset);throw new Error(`Rate limit exceeded. Please wait ${Math.ceil(e/1e3)} seconds.`)}s.requests++,this.rateLimits.set(e,s)}handleBinanceError(e,t){if(e.response?.data){const t=e.response.data;switch(t.code){case-1003:a.error("Too many requests. Please slow down.");break;case-1021:a.error("Request timestamp outside of recvWindow.");break;case-2010:a.error("Invalid symbol or trading pair.");break;case-1100:a.error("Invalid parameter sent.");break;default:a.error(`Binance API Error: ${t.msg}`)}throw new Error(`Binance API Error ${t.code}: ${t.msg}`)}throw e.message?.includes("rate limit")?a.error("Rate limit exceeded. Please wait before making more requests."):a.error(`Failed to fetch data from Binance: ${e.message}`),e}async getServerTime(){try{await this.checkRateLimit("serverTime");const e=await fetch(`${this.baseUrl}/time`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return(await e.json()).serverTime}catch(e){this.handleBinanceError(e,"getServerTime")}}async getExchangeInfo(e){try{const t=Date.now();if(this.exchangeInfoCache&&t-this.exchangeInfoCacheTime<this.exchangeInfoCacheTTL&&!e)return this.exchangeInfoCache;await this.checkRateLimit("exchangeInfo");const s=e?`${this.baseUrl}/exchangeInfo?symbol=${e}`:`${this.baseUrl}/exchangeInfo`,a=await fetch(s);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();return e||(this.exchangeInfoCache=n,this.exchangeInfoCacheTime=t),n}catch(t){this.handleBinanceError(t,"getExchangeInfo")}}async getOrderBook(e,t=100){try{await this.checkRateLimit("orderBook");const s=await fetch(`${this.baseUrl}/depth?symbol=${e}&limit=${t}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){this.handleBinanceError(s,"getOrderBook")}}async getAllTickers(){try{await this.checkRateLimit("getAllTickers");const e=await fetch(`${this.baseUrl}/ticker/24hr`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json(),s=["BTCUSDT","ETHUSDT","ADAUSDT","BNBUSDT","XRPUSDT","SOLUSDT","DOTUSDT","LINKUSDT"];return t.filter(e=>s.includes(e.symbol)).map(e=>({symbol:e.symbol,price:parseFloat(e.price),change:parseFloat(e.priceChange),changePercent:parseFloat(e.priceChangePercent),volume:parseFloat(e.volume),high:parseFloat(e.highPrice),low:parseFloat(e.lowPrice),open:parseFloat(e.openPrice)}))}catch(e){return this.handleBinanceError(e,"getAllTickers"),[]}}async get24hrTicker(e){try{await this.checkRateLimit("get24hrTicker");const t=e?`${this.baseUrl}/ticker/24hr?symbol=${e}`:`${this.baseUrl}/ticker/24hr`,s=await fetch(t);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();return Array.isArray(a)?a:[a]}catch(t){this.handleBinanceError(t,"get24hrTicker")}}async getTicker(e){try{const t=await this.get24hrTicker(e);if(0===t.length)throw new Error(`No ticker data found for ${e}`);return t[0]}catch(t){this.handleBinanceError(t,`getTicker-${e}`)}}async getSymbolTicker(e){try{await this.checkRateLimit("getSymbolTicker");const t=await fetch(`${this.baseUrl}/ticker/24hr?symbol=${e}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();return{symbol:s.symbol,price:parseFloat(s.price),change:parseFloat(s.priceChange),changePercent:parseFloat(s.priceChangePercent),volume:parseFloat(s.volume),high:parseFloat(s.highPrice),low:parseFloat(s.lowPrice),open:parseFloat(s.openPrice)}}catch(t){return this.handleBinanceError(t,`getSymbolTicker-${e}`),null}}async getKlines(e,t="1h",s=100,a,n){try{await this.checkRateLimit("getKlines");let i=`${this.baseUrl}/klines?symbol=${e}&interval=${t}&limit=${s}`;a&&(i+=`&startTime=${a}`),n&&(i+=`&endTime=${n}`);const r=await fetch(i);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return(await r.json()).map(e=>({openTime:e[0],open:e[1],high:e[2],low:e[3],close:e[4],volume:e[5],closeTime:e[6],quoteAssetVolume:e[7],numberOfTrades:e[8],takerBuyBaseAssetVolume:e[9],takerBuyQuoteAssetVolume:e[10]}))}catch(i){return this.handleBinanceError(i,`getKlines-${e}`),[]}}setupWebSocketConnection(e,t,s,n){this.connectionStateMap.set(e,"connecting");const i={ws:t,lastPong:Date.now(),reconnectAttempts:0,isManualClose:!1};return i.pingInterval=setInterval(()=>{t.readyState===WebSocket.OPEN&&(t.send(JSON.stringify({ping:Date.now()})),setTimeout(()=>{Date.now()-i.lastPong>this.pongTimeout&&t.close(1006,"Pong timeout")},this.pongTimeout))},this.pingInterval),setTimeout(()=>{i.isManualClose||t.readyState!==WebSocket.OPEN||t.close(1e3,"24-hour timeout")},this.connectionTimeout),t.addEventListener("pong",()=>{i.lastPong=Date.now()}),t.onopen=()=>{this.connectionStateMap.set(e,"connected"),i.reconnectAttempts=0,0===i.reconnectAttempts&&a.success(`Connected to ${Array.isArray(n)?"multiple symbols":n} stream`)},t.onmessage=e=>{try{const t=JSON.parse(e.data);let a=t;if(t.stream&&t.data&&(a=t.data),"24hrTicker"===a.e){const e={symbol:a.s,price:parseFloat(a.c),change:parseFloat(a.P),changePercent:parseFloat(a.P),volume:parseFloat(a.v),high:parseFloat(a.h),low:parseFloat(a.l),open:parseFloat(a.o)};s(e)}}catch(t){}},t.onerror=e=>{const t=`Connection error for ${Array.isArray(n)?"market data":n}`;0===i.reconnectAttempts&&a.error(`${t}. If this persists, your IP might be temporarily banned by Binance.`)},t.onclose=t=>{this.connectionStateMap.set(e,"disconnected"),i.pingInterval&&clearInterval(i.pingInterval);const a=this.connectionDebounceMap.get(e);a&&(clearTimeout(a),this.connectionDebounceMap.delete(e)),i.isManualClose||1e3===t.code||this.attemptReconnectWithDebounce(e,n,s,i)},i}subscribeToTicker(e,t){const s=`${e.toLowerCase()}@ticker`,a=`ticker_${e}`;if(this.websockets.has(a)){const e=this.websockets.get(a);e.isManualClose=!0,e.ws.close(1e3,"Replacing connection")}const n=new WebSocket(`${this.wsUrl}/${s}`),i=this.setupWebSocketConnection(a,n,t,e);return this.websockets.set(a,i),()=>{i.isManualClose=!0,i.pingInterval&&clearInterval(i.pingInterval),n.close(1e3,"Manual close"),this.websockets.delete(a)}}subscribeToMultipleTickers(e,t){const s="multi_ticker";if(this.websockets.has(s)){const e=this.websockets.get(s);e.isManualClose=!0,e.ws.close(1e3,"Replacing connection")}let a,n;if(a=1===e.length?`wss://data-stream.binance.vision/ws/${e[0].toLowerCase()}@ticker`:`wss://data-stream.binance.vision/stream?streams=${e.map(e=>`${e.toLowerCase()}@ticker`).join("/")}`,a.length>8e3){const t=e.slice(0,3);if(1===t.length){const e=`${t[0].toLowerCase()}@ticker`;a=`${this.wsUrl}/${e}`}else a=`wss://stream.binance.com:9443/stream?streams=${t.map(e=>`${e.toLowerCase()}@ticker`).join("/")}`}try{n=new WebSocket(a)}catch(r){if(1===e.length){const t=`${e[0].toLowerCase()}@ticker`;a=`${this.alternativeWsUrl}/${t}`}else a=`wss://data-stream.binance.vision:9443/stream?streams=${e.map(e=>`${e.toLowerCase()}@ticker`).join("/")}`;n=new WebSocket(a)}const i=this.setupWebSocketConnection(s,n,t,e);return this.websockets.set(s,i),()=>{i.isManualClose=!0,i.pingInterval&&clearInterval(i.pingInterval),n.close(1e3,"Manual close"),this.websockets.delete(s)}}attemptReconnectWithDebounce(e,t,s,n){if(!this.connectionDebounceMap.has(e)&&"connecting"!==this.connectionStateMap.get(e))if(n.reconnectAttempts<this.maxReconnectAttempts){n.reconnectAttempts++;const a=this.reconnectDelay*Math.pow(2,n.reconnectAttempts-1),i=setTimeout(()=>{if(this.connectionDebounceMap.delete(e),!n.isManualClose){this.websockets.delete(e),this.connectionStateMap.set(e,"connecting");try{Array.isArray(t)?this.subscribeToMultipleTickers(t,s):this.subscribeToTicker(t,s)}catch(i){this.connectionStateMap.set(e,"disconnected"),setTimeout(()=>{this.attemptReconnectWithDebounce(e,t,s,n)},2*a)}}},a);this.connectionDebounceMap.set(e,i)}else this.connectionStateMap.set(e,"disconnected"),a.error("Lost connection to market data. Please refresh the page."),this.websockets.delete(e)}attemptReconnect(e,t,s,a){this.attemptReconnectWithDebounce(e,t,s,a)}subscribeToKlines(e,t,s){const a=`${e.toLowerCase()}@kline_${t}`,n=`kline_${e}_${t}`;if(this.websockets.has(n)){const e=this.websockets.get(n);e.isManualClose=!0,e.ws.close(1e3,"Replacing connection")}const i=new WebSocket(`${this.wsUrl}/${a}`),r={ws:i,lastPong:Date.now(),reconnectAttempts:0,isManualClose:!1};return r.pingInterval=setInterval(()=>{i.readyState===WebSocket.OPEN&&i.send(JSON.stringify({ping:Date.now()}))},this.pingInterval),i.addEventListener("pong",()=>{r.lastPong=Date.now()}),i.onopen=()=>{r.reconnectAttempts=0},i.onmessage=e=>{try{const t=JSON.parse(e.data);if("kline"===t.e){const e=t.k,a={openTime:e.t,open:e.o,high:e.h,low:e.l,close:e.c,volume:e.v,closeTime:e.T,quoteAssetVolume:e.q,numberOfTrades:e.n,takerBuyBaseAssetVolume:e.V,takerBuyQuoteAssetVolume:e.Q};s(a)}}catch(t){}},i.onerror=e=>{},i.onclose=e=>{r.pingInterval&&clearInterval(r.pingInterval),!r.isManualClose&&e.code},this.websockets.set(n,r),()=>{r.isManualClose=!0,r.pingInterval&&clearInterval(r.pingInterval),i.close(1e3,"Manual close"),this.websockets.delete(n)}}closeAllConnections(){this.connectionDebounceMap.forEach((e,t)=>{clearTimeout(e)}),this.connectionDebounceMap.clear(),this.websockets.forEach((e,t)=>{e.isManualClose=!0,e.pingInterval&&clearInterval(e.pingInterval),e.ws.readyState!==WebSocket.OPEN&&e.ws.readyState!==WebSocket.CONNECTING||e.ws.close(1e3,"Service shutdown")}),this.websockets.clear(),this.connectionStateMap.clear(),this.userDataStreamConnection=null,this.clearListenKeyRefresh(),this.currentListenKey=null}isConnected(){return Array.from(this.websockets.values()).some(e=>e.ws.readyState===WebSocket.OPEN)}getConnectionStatus(){const e={};return this.websockets.forEach((t,s)=>{switch(t.ws.readyState){case WebSocket.CONNECTING:e[s]="connecting";break;case WebSocket.OPEN:e[s]="connected";break;case WebSocket.CLOSING:e[s]="closing";break;case WebSocket.CLOSED:e[s]="closed";break;default:e[s]="unknown"}}),e}getDetailedConnectionStatus(){const e={};return this.websockets.forEach((t,s)=>{e[s]={readyState:t.ws.readyState,reconnectAttempts:t.reconnectAttempts,lastPong:new Date(t.lastPong).toISOString(),isManualClose:t.isManualClose}}),e}async createListenKey(e){try{await this.checkRateLimit("createListenKey");const t=await fetch(`${this.baseUrl}/userDataStream`,{method:"POST",headers:{"X-MBX-APIKEY":e}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();return this.currentListenKey=s.listenKey,this.setupListenKeyRefresh(e),s.listenKey}catch(t){this.handleBinanceError(t,"createListenKey")}}async keepAliveListenKey(e,t){try{await this.checkRateLimit("keepAliveListenKey");const s=t||this.currentListenKey;if(!s)throw new Error("No listen key available");const a=await fetch(`${this.baseUrl}/userDataStream`,{method:"PUT",headers:{"X-MBX-APIKEY":e,"Content-Type":"application/x-www-form-urlencoded"},body:`listenKey=${s}`});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`)}catch(s){this.handleBinanceError(s,"keepAliveListenKey")}}async deleteListenKey(e,t){try{await this.checkRateLimit("deleteListenKey");const s=t||this.currentListenKey;if(!s)throw new Error("No listen key available");const a=await fetch(`${this.baseUrl}/userDataStream`,{method:"DELETE",headers:{"X-MBX-APIKEY":e,"Content-Type":"application/x-www-form-urlencoded"},body:`listenKey=${s}`});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);this.currentListenKey=null,this.clearListenKeyRefresh()}catch(s){this.handleBinanceError(s,"deleteListenKey")}}setupListenKeyRefresh(e){this.clearListenKeyRefresh(),this.listenKeyRefreshInterval=setInterval(async()=>{try{await this.keepAliveListenKey(e)}catch(t){a.error("Failed to refresh user data stream. Please reconnect.")}},18e5)}clearListenKeyRefresh(){this.listenKeyRefreshInterval&&(clearInterval(this.listenKeyRefreshInterval),this.listenKeyRefreshInterval=null)}subscribeToUserDataStream(e,t){return new Promise(async(s,n)=>{try{const i=this.currentListenKey||await this.createListenKey(e),r="user_data_stream";this.userDataStreamConnection&&(this.userDataStreamConnection.isManualClose=!0,this.userDataStreamConnection.ws.close(1e3,"Replacing connection"));const c=new WebSocket(`${this.wsUrl}/${i}`),o={ws:c,lastPong:Date.now(),reconnectAttempts:0,isManualClose:!1};o.pingInterval=setInterval(()=>{c.readyState===WebSocket.OPEN&&c.send(JSON.stringify({ping:Date.now()}))},this.pingInterval),c.addEventListener("pong",()=>{o.lastPong=Date.now()}),c.onopen=()=>{o.reconnectAttempts=0,a.success("Connected to account updates")},c.onmessage=e=>{try{const s=JSON.parse(e.data);switch(s.e){case"outboundAccountPosition":t.onAccountUpdate?.(s);break;case"balanceUpdate":t.onBalanceUpdate?.(s);break;case"executionReport":t.onOrderUpdate?.(s)}}catch(s){}},c.onerror=e=>{a.error("User data stream connection error"),n(e)},c.onclose=e=>{o.pingInterval&&clearInterval(o.pingInterval),o.isManualClose||1e3===e.code||a.error("Lost connection to account updates")},this.userDataStreamConnection=o,this.websockets.set(r,o),s(()=>{o.isManualClose=!0,o.pingInterval&&clearInterval(o.pingInterval),c.close(1e3,"Manual close"),this.websockets.delete(r),this.userDataStreamConnection=null,this.deleteListenKey(e).catch(console.error)})}catch(i){n(i)}})}subscribeToCombinedStreams(e,t){return new Promise((s,n)=>{if(0===e.length)return void n(new Error("No streams specified"));const i=`combined_${e.join("_")}`;if(this.websockets.has(i)){const e=this.websockets.get(i);e.isManualClose=!0,e.ws.close(1e3,"Replacing connection"),this.websockets.delete(i)}const r=e.join("/"),c=`${this.wsUrl}/stream?streams=${r}`,o=new WebSocket(c),l={ws:o,lastPong:Date.now(),reconnectAttempts:0,isManualClose:!1};l.pingInterval=setInterval(()=>{o.readyState===WebSocket.OPEN&&o.send(JSON.stringify({ping:Date.now()}))},this.pingInterval),l.connectionTimeout=setTimeout(()=>{l.isManualClose||l.ws.close(1e3,"24h timeout")},864e5),this.websockets.set(i,l),o.onopen=()=>{l.reconnectAttempts=0,a.success(`Connected to ${e.length} data streams`)},o.onmessage=e=>{try{const s=JSON.parse(e.data);if(s.pong)return void(l.lastPong=Date.now());if(s.stream&&s.data){const e=s.stream,a=s.data;e.includes("@ticker")?t.onTicker?.(a):e.includes("@kline")?t.onKline?.(a):e.includes("@depth")&&t.onDepth?.(a)}}catch(s){}},o.onerror=e=>{a.error("Combined streams connection error")},o.onclose=r=>{if(l.pingInterval&&clearInterval(l.pingInterval),l.connectionTimeout&&clearTimeout(l.connectionTimeout),!l.isManualClose&&1e3!==r.code)if(l.reconnectAttempts<5){l.reconnectAttempts++;const a=Math.min(1e3*Math.pow(2,l.reconnectAttempts),3e4);setTimeout(()=>{this.subscribeToCombinedStreams(e,t).then(s).catch(n)},a)}else a.error("Failed to reconnect to combined streams"),this.websockets.delete(i)},s(()=>{l.isManualClose=!0,l.pingInterval&&clearInterval(l.pingInterval),l.pongTimeout&&clearTimeout(l.pongTimeout),l.connectionTimeout&&clearTimeout(l.connectionTimeout),o.close(1e3,"Manual close"),this.websockets.delete(i)})})}static createStreamName(e,t,s){const a=e.toLowerCase();switch(t){case"ticker":return`${a}@ticker`;case"kline":if(!s)throw new Error("Interval required for kline stream");return`${a}@kline_${s}`;case"depth":return`${a}@depth`;default:throw new Error(`Unknown stream type: ${t}`)}}subscribeToMultipleTickersOptimized(e,t){const s=e.map(e=>N.createStreamName(e,"ticker"));return this.subscribeToCombinedStreams(s,{onTicker:t})}subscribeToMultipleKlinesOptimized(e,t){const s=e.map(({symbol:e,interval:t})=>N.createStreamName(e,"kline",t));return this.subscribeToCombinedStreams(s,{onKline:t})}}const D=new N,C=class e{constructor(){t(this,"state"),t(this,"updateInterval",null),t(this,"throttleTimeout",null),t(this,"THROTTLE_INTERVAL",6e4),t(this,"MAX_RETRIES",3),t(this,"retryCount",0),t(this,"isUpdating",!1),this.state={data:{},isConnected:!1,isLoading:!1,error:null,lastUpdate:null,subscribers:new Set}}static getInstance(){return e.instance||(e.instance=new e),e.instance}subscribe(e){return this.state.subscribers.add(e),Object.keys(this.state.data).length>0&&e(this.state.data),()=>{this.state.subscribers.delete(e)}}notifySubscribers(){this.state.subscribers.forEach(e=>{try{e(this.state.data)}catch(t){}})}updateState(e){this.state={...this.state,...e},this.notifySubscribers()}async fetchMarketData(e){if(this.isUpdating)return;if(Date.now()-(this.state.lastUpdate?.getTime()||0)<this.THROTTLE_INTERVAL)this.THROTTLE_INTERVAL;else{this.isUpdating=!0,this.updateState({isLoading:!0,error:null});try{const t=(await D.get24hrTicker()).filter(t=>e.includes(t.symbol)),s={};t.forEach(e=>{s[e.symbol]={symbol:e.symbol,price:parseFloat(e.price),change:parseFloat(e.priceChange),changePercent:parseFloat(e.priceChangePercent),volume:parseFloat(e.volume),high:parseFloat(e.highPrice),low:parseFloat(e.lowPrice),open:parseFloat(e.openPrice)}}),this.updateState({data:s,isLoading:!1,isConnected:!0,lastUpdate:new Date,error:null}),this.retryCount=0}catch(t){const s=t instanceof Error?t.message:"Failed to fetch market data";if(this.retryCount<this.MAX_RETRIES){this.retryCount++;const t=Math.min(1e3*Math.pow(2,this.retryCount-1),1e4);setTimeout(()=>{this.fetchMarketData(e)},t)}else this.updateState({error:s,isConnected:!1,isLoading:!1}),a.error(`Market data error: ${s}`),this.retryCount=0}finally{this.isUpdating=!1}}}startAutoUpdate(e,t=this.THROTTLE_INTERVAL){this.stopAutoUpdate(),this.fetchMarketData(e),this.updateInterval=setInterval(()=>{this.fetchMarketData(e)},t)}stopAutoUpdate(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null)}getState(){return{...this.state}}getSymbolData(e){return this.state.data[e]||null}getAllData(){return Object.values(this.state.data)}hasSymbol(e){return e in this.state.data}async refresh(e){await this.fetchMarketData(e)}reset(){this.stopAutoUpdate(),this.state={data:{},isConnected:!1,isLoading:!1,error:null,lastUpdate:null,subscribers:new Set},this.retryCount=0,this.isUpdating=!1}destroy(){this.stopAutoUpdate(),this.state.subscribers.clear(),e.instance=null}async getExchangeInfo(){try{return{symbols:[{symbol:"BTCUSDT",status:"TRADING",baseAsset:"BTC",quoteAsset:"USDT",filters:[]},{symbol:"ETHUSDT",status:"TRADING",baseAsset:"ETH",quoteAsset:"USDT",filters:[]}],serverTime:Date.now()}}catch(e){throw e}}async getAllTickers(){try{return Object.values(this.state.data)}catch(e){throw e}}async getTicker(e){try{const t=this.getSymbolData(e);if(!t)throw new Error(`No data available for symbol: ${e}`);return t}catch(t){throw t}}async getOrderBook(e,t=100){try{return{symbol:e,bids:[["50000","1.0"],["49999","2.0"]],asks:[["50001","1.5"],["50002","2.5"]],timestamp:Date.now()}}catch(s){throw s}}async getKlines(e,t,s=500){try{const e=Date.now(),t=[];for(let a=0;a<s;a++)t.push([e-6e4*a,"50000","50100","49900","50050","100",e-6e4*a+59999,"5000000",100,"50","2500000","0"]);return t.reverse()}catch(a){throw a}}async getRecentTrades(e,t=100){try{const e=[];for(let s=0;s<t;s++)e.push({id:s,price:"50000",qty:"0.01",quoteQty:"500",time:Date.now()-1e3*s,isBuyerMaker:s%2==0,isBestMatch:!0});return e}catch(s){throw s}}};t(C,"instance",null);const L=C.getInstance(),I={isConnected:!1,isConnecting:!1,reconnectAttempts:0,lastError:null},E=["BTCUSDT","ETHUSDT","BNBUSDT","ADAUSDT","SOLUSDT"],P=n()(i((e,t)=>({tickers:{},orderBooks:{},exchangeInfo:null,wsState:I,selectedSymbols:E,isLoading:!1,error:null,lastUpdate:0,isConnected:!1,connectionStatus:"disconnected",connect:()=>{e(e=>{e.isConnected=!0,e.connectionStatus="connected",e.wsState.isConnected=!0})},setTicker:(t,s)=>e(e=>{e.tickers[t]=s,e.lastUpdate=Date.now()}),setOrderBook:(t,s)=>e(e=>{e.orderBooks[t]=s,e.lastUpdate=Date.now()}),setExchangeInfo:t=>e(e=>{e.exchangeInfo=t}),setWebSocketState:t=>e(e=>{Object.assign(e.wsState,t)}),setSelectedSymbols:t=>e(e=>{e.selectedSymbols=t}),addSelectedSymbol:t=>e(e=>{e.selectedSymbols.includes(t)||e.selectedSymbols.push(t)}),removeSelectedSymbol:t=>e(e=>{e.selectedSymbols=e.selectedSymbols.filter(e=>e!==t)}),setLoading:t=>e(e=>{e.isLoading=t}),setError:t=>e(e=>{e.error=t}),updateLastUpdate:()=>e(e=>{e.lastUpdate=Date.now()}),fetchTicker:async s=>{try{e(e=>{e.isLoading=!0,e.error=null}),await L.fetchMarketData([s]);const a=L.getSymbolData(s);if(!a)throw new Error("No data received for symbol");{const e={symbol:a.symbol,price:a.price.toString(),priceChange:a.change.toString(),priceChangePercent:a.changePercent.toString(),volume:a.volume.toString(),high:a.high.toString(),low:a.low.toString(),open:a.open.toString(),timestamp:Date.now()};t().setTicker(s,e)}}catch(a){e(e=>{e.error=a.message})}finally{e(e=>{e.isLoading=!1})}},fetchOrderBook:async t=>{try{e(e=>{e.isLoading=!0,e.error=null}),e(e=>{e.isLoading=!1})}catch(s){e(e=>{e.error=s.message,e.isLoading=!1})}},fetchExchangeInfo:async()=>{try{e(e=>{e.isLoading=!0,e.error=null}),e(e=>{e.isLoading=!1})}catch(t){e(e=>{e.error=t.message,e.isLoading=!1})}},connectWebSocket:()=>{e(e=>{e.wsState.isConnected=!1,e.wsState.isConnecting=!1})},disconnectWebSocket:()=>{e(e=>{e.wsState={...I}})},subscribeToTicker:e=>{},unsubscribeFromTicker:e=>{},fetchMultipleTickers:async s=>{try{e(e=>{e.isLoading=!0,e.error=null});const a=s.map(e=>t().fetchTicker(e));await Promise.allSettled(a)}finally{e(e=>{e.isLoading=!1})}},subscribeToMultipleTickers:e=>{},reset:()=>e(e=>{e.tickers={},e.orderBooks={},e.exchangeInfo=null,e.wsState={...I},e.selectedSymbols=E,e.isLoading=!1,e.error=null,e.lastUpdate=0})})));"undefined"!=typeof window&&(async()=>{const e=P.getState();try{await e.fetchExchangeInfo(),await e.fetchMultipleTickers(e.selectedSymbols),e.connectWebSocket(),e.subscribeToMultipleTickers(e.selectedSymbols)}catch(t){}})();const M={sidebarCollapsed:!1,chartHeight:400,showOrderBook:!0,showTradeHistory:!0,compactMode:!1},A={type:"candlestick",timeFrame:"1h",showVolume:!0,showIndicators:!0,gridLines:!0,crosshair:!0},$={priceAlerts:!0,tradingSignals:!0,systemUpdates:!0,sound:!1},R={settings:!1,profile:!1,help:!1,about:!1},O=n()(r(i((e,t)=>({theme:"system",currentPage:"dashboard",layout:M,chart:A,notifications:$,modals:R,globalLoading:!1,globalError:null,toasts:[],setTheme:t=>e(e=>{e.theme=t}),setCurrentPage:t=>e(e=>{e.currentPage=t}),updateLayout:t=>e(e=>{Object.assign(e.layout,t)}),updateChart:t=>e(e=>{Object.assign(e.chart,t)}),updateNotifications:t=>e(e=>{Object.assign(e.notifications,t)}),openModal:t=>e(e=>{e.modals[t]=!0}),closeModal:t=>e(e=>{e.modals[t]=!1}),closeAllModals:()=>e(e=>{Object.keys(e.modals).forEach(t=>{e.modals[t]=!1})}),setGlobalLoading:t=>e(e=>{e.globalLoading=t}),setGlobalError:t=>e(e=>{e.globalError=t}),addToast:s=>e(e=>{const a=Math.random().toString(36).substr(2,9),n={...s,id:a,timestamp:Date.now(),duration:s.duration??5e3};e.toasts.push(n),n.duration>0&&setTimeout(()=>{t().removeToast(a)},n.duration)}),removeToast:t=>e(e=>{e.toasts=e.toasts.filter(e=>e.id!==t)}),clearToasts:()=>e(e=>{e.toasts=[]}),reset:()=>e(e=>{e.theme="system",e.currentPage="dashboard",e.layout={...M},e.chart={...A},e.notifications={...$},e.modals={...R},e.globalLoading=!1,e.globalError=null,e.toasts=[]})})),{name:"smc-ui-store",partialize:e=>({theme:e.theme,layout:e.layout,chart:e.chart,notifications:e.notifications})}));"undefined"!=typeof window&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{const{theme:e}=O.getState();"system"===e&&O.setState(e=>({...e}))});const U=()=>{const e=b(e=>e.user),{wsState:{isConnected:t},error:s}=P(),{addToast:a}=O(),[n,i]=c.useState({trades:[],signals:[],sessions:[],isConnected:!1,connectionError:null,marketDataConnected:!1}),[r,o]=c.useState(new Map),l=c.useCallback(e=>{const{eventType:t,new:s,old:n}=e;i(e=>{let i=[...e.trades];switch(t){case"INSERT":i.push(s),a({type:"success",title:"Nowa transakcja",message:`${s.symbol} ${s.side}`});break;case"UPDATE":const e=i.findIndex(e=>e.id===s.id);-1!==e&&(i[e]=s,"filled"===s.status?a({type:"success",title:"Transakcja wykonana",message:s.symbol}):"cancelled"===s.status&&a({type:"info",title:"Transakcja anulowana",message:s.symbol}));break;case"DELETE":i=i.filter(e=>e.id!==n.id)}return{...e,trades:i}})},[]),h=c.useCallback(e=>{const{eventType:t,new:s,old:n}=e;i(e=>{let i=[...e.signals];switch(t){case"INSERT":i.unshift(s),i.length>100&&(i=i.slice(0,100)),s.confidence>=.8&&a({type:"success",title:"Połączenie",message:`Nowy sygnał SMC: ${s.symbol} (${(100*s.confidence).toFixed(0)}%)`,duration:6e3});break;case"UPDATE":const e=i.findIndex(e=>e.id===s.id);-1!==e&&(i[e]=s,s.processed&&!n.processed&&a({type:"info",title:"Sygnał przetworzony",message:s.symbol}));break;case"DELETE":i=i.filter(e=>e.id!==n.id)}return{...e,signals:i}})},[]),d=c.useCallback(e=>{const{eventType:t,new:s,old:n}=e;i(e=>{let i=[...e.sessions];switch(t){case"INSERT":i.push(s),a({type:"success",title:"Sesja rozpoczęta",message:"Nowa sesja tradingowa rozpoczęta"});break;case"UPDATE":const e=i.findIndex(e=>e.id===s.id);-1!==e&&(i[e]=s,"completed"===s.status&&"active"===n.status&&a({type:"info",title:"Sesja zakończona",message:"Sesja tradingowa zakończona"}));break;case"DELETE":i=i.filter(e=>e.id!==n.id)}return{...e,sessions:i}})},[]),m=c.useCallback(s=>{if(!e)return;const a=`${s}_${e.id}`;if(r.has(a))return;let n;try{if("trades"===s)n=x.subscribeTrades(e.id,l);else if("smc_signals"===s)n=x.subscribeSignals(h);else{if("trading_sessions"!==s)return;n=x.subscribeSessions(e.id,d)}n.on("system",{event:"*"},e=>{"connected"===e.type?i(e=>({...e,isConnected:!0,connectionError:null,marketDataConnected:t})):"error"===e.type&&i(t=>({...t,isConnected:!1,connectionError:e.message||"Connection error",marketDataConnected:!1}))}),o(e=>new Map(e.set(a,n)))}catch(c){i(e=>({...e,connectionError:`Failed to subscribe to ${s}`}))}},[e,r,l,h,d]),u=c.useCallback(t=>{if(!e)return;const s=`${t}_${e.id}`,a=r.get(s);a&&(x.unsubscribe(a),o(e=>{const t=new Map(e);return t.delete(s),t}))},[e,r]),p=c.useCallback(()=>{r.forEach(e=>{x.unsubscribe(e)}),o(new Map),i(e=>({...e,isConnected:!1,connectionError:null}))},[r]),g=c.useCallback(async()=>{if(e)try{i(e=>({...e,trades:[],signals:[],sessions:[]}))}catch(t){a({type:"error",title:"Błąd",message:"Błąd podczas odświeżania danych"})}},[e]);return c.useEffect(()=>{i(e=>({...e,marketDataConnected:t,connectionError:s||e.connectionError}))},[t,s]),c.useEffect(()=>(e?(m("trades"),m("smc_signals"),m("trading_sessions")):p(),()=>{p()}),[e]),c.useEffect(()=>()=>{p()},[]),{...n,subscribeTo:m,unsubscribeFrom:u,unsubscribeAll:p,refreshData:g}},B=new class{constructor(){t(this,"isRunning",!1),t(this,"intervals",new Map),t(this,"priceHistory",new Map),t(this,"HISTORY_LIMIT",200),t(this,"ANALYSIS_SYMBOLS",["BTCUSDT","ETHUSDT","BNBUSDT","ADAUSDT","SOLUSDT"]),this.initializePriceHistory()}async initializePriceHistory(){for(const e of this.ANALYSIS_SYMBOLS)this.priceHistory.set(e,[])}start(){this.isRunning||(this.isRunning=!0,this.ANALYSIS_SYMBOLS.forEach(e=>{this.startSymbolAnalysis(e)}))}stop(){this.isRunning=!1,this.intervals.forEach(e=>clearInterval(e)),this.intervals.clear()}startSymbolAnalysis(e){const t=setInterval(async()=>{if(this.isRunning)try{await this.updatePriceData(e),await this.analyzeSymbol(e)}catch(t){}},15e3);this.intervals.set(e,t)}async updatePriceData(e){D.isConnected()}updatePriceFromWebSocket(e,t){if(!t)return;const s=this.priceHistory.get(e)||[],a=Date.now(),n={open:t.open||(s.length>0?s[s.length-1].close:t.price),high:t.high||t.price,low:t.low||t.price,close:t.close||t.price,volume:t.volume||0,timestamp:a};s.push(n),s.length>this.HISTORY_LIMIT&&s.shift(),this.priceHistory.set(e,s)}async analyzeSymbol(e){const t=this.priceHistory.get(e);if(!t||t.length<50)return;const s=[...this.detectBreakOfStructure(e,t),...this.detectChangeOfCharacter(e,t),...this.detectFairValueGaps(e,t),...this.detectOrderBlocks(e,t),...this.detectLiquidity(e,t)];for(const a of s)a.confidence>=.7&&await this.createSignal(e,a)}detectBreakOfStructure(e,t){const s=[],a=t.slice(-20);if(a.length<10)return s;const n=this.findSwingHighs(a),i=this.findSwingLows(a),r=a[a.length-1].close;if(n.length>0){const e=Math.max(...n.map(e=>e.price));r>1.002*e&&s.push({type:"BOS",direction:"bullish",confidence:this.calculateBOSConfidence(a,"bullish"),price:r,timestamp:Date.now(),metadata:{timeframe:"15m",volume:a[a.length-1].volume,strength:(r-e)/e}})}if(i.length>0){const e=Math.min(...i.map(e=>e.price));r<.998*e&&s.push({type:"BOS",direction:"bearish",confidence:this.calculateBOSConfidence(a,"bearish"),price:r,timestamp:Date.now(),metadata:{timeframe:"15m",volume:a[a.length-1].volume,strength:(e-r)/e}})}return s}detectChangeOfCharacter(e,t){const s=[],a=t.slice(-30);if(a.length<15)return s;const n=this.identifyTrend(a.slice(-15)),i=this.identifyTrend(a.slice(-30,-15));return n!==i&&"sideways"!==n&&s.push({type:"CHoCH",direction:"bullish"===n?"bullish":"bearish",confidence:.75,price:a[a.length-1].close,timestamp:Date.now(),metadata:{timeframe:"15m",previousTrend:i,currentTrend:n}}),s}detectFairValueGaps(e,t){const s=[],a=t.slice(-10);if(a.length<3)return s;for(let n=1;n<a.length-1;n++){const e=a[n-1],t=a[n],i=a[n+1];if(e.high<i.low&&t.close>t.open){const t=(i.low-e.high)/e.high;t>.001&&s.push({type:"FVG",direction:"bullish",confidence:Math.min(.9,.6+100*t),price:(e.high+i.low)/2,timestamp:Date.now(),metadata:{timeframe:"15m",gapSize:t,topPrice:i.low,bottomPrice:e.high}})}if(e.low>i.high&&t.close<t.open){const t=(e.low-i.high)/i.high;t>.001&&s.push({type:"FVG",direction:"bearish",confidence:Math.min(.9,.6+100*t),price:(e.low+i.high)/2,timestamp:Date.now(),metadata:{timeframe:"15m",gapSize:t,topPrice:e.low,bottomPrice:i.high}})}}return s}detectOrderBlocks(e,t){const s=[],a=t.slice(-20);if(a.length<5)return s;const n=a.reduce((e,t)=>e+t.volume,0)/a.length;for(let i=1;i<a.length-1;i++){const e=a[i];if(e.volume>1.5*n){const t=Math.abs(e.close-e.open),a=e.high-e.low;e.close>e.open&&t>.7*a&&s.push({type:"OB",direction:"bullish",confidence:.7,price:e.low,timestamp:Date.now(),metadata:{timeframe:"15m",volume:e.volume,volumeRatio:e.volume/n,highPrice:e.high,lowPrice:e.low}}),e.close<e.open&&t>.7*a&&s.push({type:"OB",direction:"bearish",confidence:.7,price:e.high,timestamp:Date.now(),metadata:{timeframe:"15m",volume:e.volume,volumeRatio:e.volume/n,highPrice:e.high,lowPrice:e.low}})}}return s}detectLiquidity(e,t){const s=[],a=t.slice(-15);if(a.length<10)return s;const n=this.findSwingHighs(a),i=this.findSwingLows(a);for(let r=0;r<n.length-1;r++)for(let e=r+1;e<n.length;e++)Math.abs(n[r].price-n[e].price)/n[r].price<.005&&s.push({type:"LQ",direction:"bearish",confidence:.65,price:(n[r].price+n[e].price)/2,timestamp:Date.now(),metadata:{timeframe:"15m",liquidityType:"sell-side",priceLevel:(n[r].price+n[e].price)/2}});for(let r=0;r<i.length-1;r++)for(let e=r+1;e<i.length;e++)Math.abs(i[r].price-i[e].price)/i[r].price<.005&&s.push({type:"LQ",direction:"bullish",confidence:.65,price:(i[r].price+i[e].price)/2,timestamp:Date.now(),metadata:{timeframe:"15m",liquidityType:"buy-side",priceLevel:(i[r].price+i[e].price)/2}});return s}findSwingHighs(e){const t=[];for(let s=2;s<e.length-2;s++){const a=e[s];a.high>e[s-1].high&&a.high>e[s-2].high&&a.high>e[s+1].high&&a.high>e[s+2].high&&t.push({price:a.high,index:s})}return t}findSwingLows(e){const t=[];for(let s=2;s<e.length-2;s++){const a=e[s];a.low<e[s-1].low&&a.low<e[s-2].low&&a.low<e[s+1].low&&a.low<e[s+2].low&&t.push({price:a.low,index:s})}return t}calculateBOSConfidence(e,t){const s=e.slice(-3).reduce((e,t)=>e+t.volume,0)/3,a=e.reduce((e,t)=>e+t.volume,0)/e.length,n=Math.min(1,s/a);return Math.min(.95,.7+.2*(n-1))}identifyTrend(e){if(e.length<5)return"sideways";const t=e[0].close,s=(e[e.length-1].close-t)/t;return s>.01?"bullish":s<-.01?"bearish":"sideways"}async createSignal(e,t){try{const s={symbol:e,signal_type:t.type,direction:t.direction,confidence:t.confidence,price:t.price,timeframe:t.metadata.timeframe,metadata:t.metadata,processed:!1,created_at:(new Date).toISOString()},{data:n,error:i}=await k.signals.create(s);if(i)return;t.confidence>=.8&&a.success(`Nowy sygnał ${t.type}: ${e} ${t.direction} (${(100*t.confidence).toFixed(0)}%)`,{duration:6e3})}catch(s){}}},F=new class{constructor(){t(this,"isRunning",!1),t(this,"detectionIntervals",new Map),t(this,"activeDetections",0),t(this,"config"),t(this,"lastPatternCheck",new Map),t(this,"priceDataCache",new Map),this.config={symbols:["BTCUSDT","ETHUSDT","BNBUSDT","ADAUSDT","SOLUSDT"],intervals:["5m","15m","1h"],detectionIntervalMs:3e4,maxConcurrentDetections:3}}async start(){if(!this.isRunning){this.isRunning=!0;for(const e of this.config.symbols)for(const t of this.config.intervals){const s=`${e}_${t}`;this.startPatternDetectionForPair(e,t,s)}a.success("Background pattern detection started",{description:`Monitoring ${this.config.symbols.length} symbols across ${this.config.intervals.length} timeframes`})}}stop(){if(this.isRunning){this.isRunning=!1;for(const[e,t]of this.detectionIntervals)clearInterval(t),this.detectionIntervals.delete(e);this.activeDetections=0,this.lastPatternCheck.clear(),this.priceDataCache.clear(),a.info("Background pattern detection stopped")}}getCachedPriceData(e){return this.priceDataCache.get(e)||null}updatePriceData(e,t){if(!t)return;const s={timestamp:Date.now(),open:t.open||t.price,high:t.high||t.price,low:t.low||t.price,close:t.close||t.price,volume:t.volume||0},a=this.priceDataCache.get(e)||[];a.push(s),a.length>200&&a.shift(),this.priceDataCache.set(e,a)}startPatternDetectionForPair(e,t,s){const a=setInterval(async()=>{if(this.activeDetections>=this.config.maxConcurrentDetections)return;const a=this.lastPatternCheck.get(s)||0,n=Date.now();if(!(n-a<.8*this.config.detectionIntervalMs)){this.activeDetections++,this.lastPatternCheck.set(s,n);try{await this.detectPatternsForPair(e,t)}catch(i){}finally{this.activeDetections--}}},this.config.detectionIntervalMs);this.detectionIntervals.set(s,a)}async detectPatternsForPair(e,t){try{if(!D.isConnected())return;const s=this.getCachedPriceData(e);if(!s||s.length<50)return;const n=await this.analyzeForPatterns(e,s,t);if(n.length>0)for(const i of n)i.confidence>.7&&a.success(`New ${i.type} pattern detected`,{description:`${e} ${t} - Confidence: ${(100*i.confidence).toFixed(1)}%`})}catch(s){}}async analyzeForPatterns(e,t,s){const a=[];try{const n=this.detectBreakOfStructure(t);n&&a.push({type:"BOS",symbol:e,interval:s,confidence:n.confidence,price:n.price,timestamp:Date.now()});const i=this.detectChangeOfCharacter(t);i&&a.push({type:"CHoCH",symbol:e,interval:s,confidence:i.confidence,price:i.price,timestamp:Date.now()});const r=this.detectFairValueGap(t);r&&a.push({type:"FVG",symbol:e,interval:s,confidence:r.confidence,price:r.price,timestamp:Date.now()});const c=this.detectOrderBlock(t);c&&a.push({type:"OB",symbol:e,interval:s,confidence:c.confidence,price:c.price,timestamp:Date.now()})}catch(n){}return a}detectBreakOfStructure(e){if(e.length<20)return null;const t=e.slice(-20),s=t.map(e=>e.high),a=t.map(e=>e.low),n=Math.max(...s.slice(-5));if(n>1.002*Math.max(...s.slice(-15,-5)))return{confidence:.75,price:n,direction:"bullish"};const i=Math.min(...a.slice(-5));return i<.998*Math.min(...a.slice(-15,-5))?{confidence:.75,price:i,direction:"bearish"}:null}detectChangeOfCharacter(e){if(e.length<30)return null;const t=e.slice(-30).map(e=>e.close),s=t.slice(-10).reduce((e,t)=>e+t,0)/10,a=t.slice(-20,-10).reduce((e,t)=>e+t,0)/10,n=t[t.length-1];return s>1.005*a&&n>s?{confidence:.65,price:n,direction:"bullish_reversal"}:s<.995*a&&n<s?{confidence:.65,price:n,direction:"bearish_reversal"}:null}detectFairValueGap(e){if(e.length<10)return null;const t=e.slice(-10);for(let s=1;s<t.length-1;s++){const e=t[s-1],a=t[s],n=t[s+1];if(e.high<n.low&&a.close>a.open){const t=(n.low-e.high)/e.high;if(t>.001)return{confidence:Math.min(.8,100*t),price:(e.high+n.low)/2,direction:"bullish"}}if(e.low>n.high&&a.close<a.open){const t=(e.low-n.high)/n.high;if(t>.001)return{confidence:Math.min(.8,100*t),price:(e.low+n.high)/2,direction:"bearish"}}}return null}detectOrderBlock(e){if(e.length<15)return null;const t=e.slice(-15);for(let s=5;s<t.length-2;s++){const e=t[s],a=Math.abs(e.close-e.open),n=e.high-e.low;if((n-a)/n>.6&&n>3*a&&(e.volume||0)>t.slice(s-5,s).reduce((e,t)=>e+(t.volume||0),0)/5*1.5)return{confidence:.7,price:(e.high+e.low)/2,direction:e.close>e.open?"bullish_ob":"bearish_ob"}}return null}getStatus(){return{isRunning:this.isRunning,activeDetections:this.activeDetections,monitoredPairs:this.config.symbols.length*this.config.intervals.length}}updateConfig(e){this.config={...this.config,...e},this.isRunning&&(this.stop(),setTimeout(()=>this.start(),1e3))}},_=c.lazy(()=>s(()=>import("./TradingViewChart-DKbBXSVx.js"),__vite__mapDeps([0,1,2]))),K=c.lazy(()=>s(()=>import("./LiveSignals-BYBenura.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),H=c.lazy(()=>s(()=>import("./LiveTrades-C7U-HVhN.js"),__vite__mapDeps([9,1,2,4,5,6,7,8]))),z=c.lazy(()=>s(()=>import("./RealtimeStatus-DD3TxqFc.js"),__vite__mapDeps([4,1,2,5,6,7,8]))),W=["BTCUSDT","ETHUSDT","BNBUSDT","ADAUSDT","SOLUSDT"],q=[{symbol:"BTCUSDT",side:"LONG",size:.5,entryPrice:42800,currentPrice:43250.5,pnl:225.25,pnlPercent:1.05},{symbol:"ETHUSDT",side:"SHORT",size:2,entryPrice:2680,currentPrice:2650.75,pnl:58.5,pnlPercent:1.09}],V=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[e,t]=c.useState(new Date),{user:s,profile:a}=b(),{tickers:n,wsState:i,error:r}=P(),x=i.isConnected,{addToast:k}=O(),{trades:N,signals:D,isConnected:C,marketDataConnected:I}=U(),{data:E,isLoading:M}=((e=!0)=>o({queryKey:v.marketData.tickers(),queryFn:async()=>{try{return await L.getAllTickers()}catch(e){throw S(e,"all tickers"),e}},enabled:e,staleTime:1e4,gcTime:12e4,refetchInterval:5e3}))(),[A,$]=c.useState(!1),[R,V]=c.useState(!1),G=[{name:"Supabase Realtime",status:C?"healthy":"error",latency:C?"12ms":"N/A"},{name:"Binance Market Data",status:x?"healthy":"error",latency:x?"8ms":"N/A"},{name:"SMC Signal Generator",status:A?"healthy":"warning",latency:A?"15ms":"N/A"},{name:"Pattern Detection",status:R?"healthy":"warning",latency:R?"20ms":"N/A"},{name:"Database Connection",status:I?"healthy":"warning",latency:I?"5ms":"N/A"}];c.useEffect(()=>{const e=setInterval(()=>{t(new Date)},1e3);return()=>{clearInterval(e)}},[]),c.useEffect(()=>((async()=>{if(s&&!A)try{B.start(),await F.start(),V(!0),$(!0),k({type:"success",title:"System Started",message:"Trading system initialized successfully"})}catch(e){k({type:"error",title:"System Error",message:"Failed to initialize trading system"})}})(),()=>{A&&B.stop(),R&&F.stop()}),[s,A,R]);const Y=W.map(e=>(e=>{const t=n[e];if(t)return{symbol:e,price:parseFloat(t.price),change:parseFloat(t.priceChangePercent),volume:t.volume};const s=E?.find(t=>t.symbol===e);return s?{symbol:e,price:parseFloat(s.price),change:parseFloat(s.priceChangePercent),volume:s.volume}:null})(e)).filter(Boolean),J=N.filter(e=>"filled"===e.status),X=J.length>0?J.reduce((e,t)=>e+("buy"===t.side?t.price*t.quantity*.01:t.price*t.quantity*-.01),0):q.reduce((e,t)=>e+t.pnl,0);return l.jsxs(l.Fragment,{children:[l.jsx(j,{title:"Trading Dashboard - SMC Trading Agent",description:"Real-time trading dashboard with market data, performance metrics, and live signals for cryptocurrency trading.",keywords:"trading dashboard, cryptocurrency, market data, trading signals, portfolio"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Trading Dashboard"}),l.jsxs("p",{className:"text-gray-600",children:["Witaj ",a?.full_name||s?.email||"Trader","! Real-time market overview and performance metrics"]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx(c.Suspense,{fallback:l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[l.jsx("div",{className:"animate-pulse h-4 w-4 bg-gray-300 rounded"}),l.jsx("span",{children:"Loading status..."})]}),children:l.jsx(z,{})}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[l.jsx(h,{className:"h-4 w-4"}),l.jsx("span",{children:e.toLocaleTimeString()})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(d,{className:"h-8 w-8 text-green-600"})}),l.jsx("div",{className:"ml-5 w-0 flex-1",children:l.jsxs("dl",{children:[l.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total P&L"}),l.jsxs("dd",{className:T("text-lg font-medium",X>=0?"text-green-600":"text-red-600"),children:["$",X.toFixed(2)]})]})})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(m,{className:"h-8 w-8 text-blue-600"})}),l.jsx("div",{className:"ml-5 w-0 flex-1",children:l.jsxs("dl",{children:[l.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Sharpe Ratio"}),l.jsx("dd",{className:"text-lg font-medium text-gray-900",children:"1.67"})]})})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(u,{className:"h-8 w-8 text-red-600"})}),l.jsx("div",{className:"ml-5 w-0 flex-1",children:l.jsxs("dl",{children:[l.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Max Drawdown"}),l.jsx("dd",{className:"text-lg font-medium text-gray-900",children:"-3.2%"})]})})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(p,{className:"h-8 w-8 text-purple-600"})}),l.jsx("div",{className:"ml-5 w-0 flex-1",children:l.jsxs("dl",{children:[l.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Aktywne sygnały"}),l.jsx("dd",{className:"text-lg font-medium text-gray-900",children:D.length})]})})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsx(c.Suspense,{fallback:l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-gray-300 rounded mb-4"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"h-4 bg-gray-300 rounded"}),l.jsx("div",{className:"h-4 bg-gray-300 rounded"}),l.jsx("div",{className:"h-4 bg-gray-300 rounded"})]})]})}),children:l.jsx(K,{className:"",maxSignals:10})}),l.jsx(c.Suspense,{fallback:l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-gray-300 rounded mb-4"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"h-4 bg-gray-300 rounded"}),l.jsx("div",{className:"h-4 bg-gray-300 rounded"}),l.jsx("div",{className:"h-4 bg-gray-300 rounded"})]})]})}),children:l.jsx(H,{className:"",maxTrades:10})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Market Overview"})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"space-y-4",children:M?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto mb-2"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Ładowanie danych rynkowych..."})]}):Y.length>0?Y.map(e=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(g,{className:"h-5 w-5 text-gray-400"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.symbol}),l.jsxs("p",{className:"text-xs text-gray-500",children:["Vol: ",parseFloat(e.volume).toLocaleString()]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["$",e.price.toLocaleString()]}),l.jsxs("p",{className:T("text-xs",e.change>=0?"text-green-600":"text-red-600"),children:[e.change>=0?"+":"",e.change.toFixed(2),"%"]})]})]},e.symbol)):l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-gray-500",children:x?"Brak danych dla śledzonych symboli":"Brak połączenia z Binance API"}),r&&l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(y,{className:"h-5 w-5 text-red-500 mr-2"}),l.jsx("span",{className:"text-red-700",children:r})]})})]})})})]}),l.jsx("div",{className:"lg:col-span-2",children:l.jsx(c.Suspense,{fallback:l.jsx("div",{className:"bg-white rounded-lg shadow p-6 h-[500px] flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading TradingView Chart..."})]})}),children:l.jsx(_,{symbol:"BTCUSDT",interval:"15m",height:500,className:"h-full"})})}),l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Active Positions"})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"space-y-4",children:q.map((e,t)=>l.jsxs("div",{className:"border rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.symbol}),l.jsx("span",{className:T("px-2 py-1 text-xs font-medium rounded","LONG"===e.side?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.side})]}),l.jsxs("div",{className:T("text-sm font-medium",e.pnl>=0?"text-green-600":"text-red-600"),children:["$",e.pnl.toFixed(2)," (",e.pnlPercent.toFixed(2),"%)"]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs text-gray-500",children:[l.jsxs("div",{children:[l.jsx("span",{className:"block",children:"Size"}),l.jsx("span",{className:"text-gray-900",children:e.size})]}),l.jsxs("div",{children:[l.jsx("span",{className:"block",children:"Entry"}),l.jsxs("span",{className:"text-gray-900",children:["$",e.entryPrice.toLocaleString()]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"block",children:"Current"}),l.jsxs("span",{className:"text-gray-900",children:["$",e.currentPrice.toLocaleString()]})]})]})]},t))})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"System Health"})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:G.map(e=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"flex-shrink-0",children:"healthy"===e.status?l.jsx(f,{className:"h-5 w-5 text-green-500"}):"warning"===e.status?l.jsx(w,{className:"h-5 w-5 text-yellow-500"}):l.jsx(w,{className:"h-5 w-5 text-red-500"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),l.jsx("p",{className:"text-xs text-gray-500",children:e.latency})]})]},e.name))})})]})]})]})}},Symbol.toStringTag,{value:"Module"}));export{V as D,P as a,U as u};

import{r as e,Y as s,j as t,b as a,I as r,G as l,A as c,T as i,y as d}from"./react-m-WA-DAu.js";import{s as n}from"./index-BH92hES8.js";import"./vendor-CCzY5YmT.js";import"./utils-qIfB5D_q.js";const m=()=>{const[m,x]=e.useState(null),[o,h]=e.useState([]),[g,j]=e.useState(null),[u,b]=e.useState(!0);e.useEffect(()=>{N()},[]);const N=async()=>{try{const{data:{session:e}}=await n.auth.getSession();if(!e)return void s.error("Please log in to view security dashboard");const t={Authorization:`Bearer ${e.access_token}`},a=await fetch("/api/security/mfa-compliance",{headers:t});if(a.ok){const e=await a.json();x(e)}const r=await fetch("/api/security/alerts",{headers:t});if(r.ok){const e=await r.json();h(e.alerts)}const l=await fetch("/api/security/stats",{headers:t});if(l.ok){const e=await l.json();j(e)}}catch(e){s.error("Failed to load security dashboard")}finally{b(!1)}},p=e=>{switch(e){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},y=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-6",children:[m&&t.jsxs("div",{className:`rounded-lg border-2 p-6 ${(e=>{switch(e){case"critical":return"text-red-600 bg-red-50 border-red-200";case"low":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"high":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}})(m.complianceLevel)}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(a,{className:"h-8 w-8"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",children:"MFA Compliance Status"}),t.jsxs("p",{className:"text-sm opacity-80",children:["Security Level: ",m.complianceLevel.charAt(0).toUpperCase()+m.complianceLevel.slice(1)]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-2xl font-bold",children:m.methodCount}),t.jsx("div",{className:"text-sm opacity-80",children:"Methods Enabled"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Enabled Methods:"}),m.enabledMethods.length>0?t.jsx("ul",{className:"text-sm space-y-1",children:m.enabledMethods.map((e,s)=>t.jsxs("li",{className:"flex items-center space-x-2",children:[t.jsx(r,{className:"h-4 w-4"}),t.jsx("span",{children:e})]},s))}):t.jsx("p",{className:"text-sm opacity-80",children:"No MFA methods enabled"})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Recommendations:"}),t.jsx("ul",{className:"text-sm space-y-1",children:m.recommendations.slice(0,3).map((e,s)=>t.jsxs("li",{className:"flex items-start space-x-2",children:[t.jsx("span",{className:"text-xs mt-1",children:"â€¢"}),t.jsx("span",{children:e})]},s))})]})]})]}),o.length>0&&t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[t.jsx(l,{className:"h-5 w-5 mr-2"}),"Security Alerts"]}),t.jsx("div",{className:"space-y-3",children:o.map((e,s)=>t.jsx("div",{className:`rounded-lg border p-4 ${p(e.severity)}`,children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium",children:e.title}),t.jsx("p",{className:"text-sm mt-1",children:e.message})]}),t.jsx("div",{className:"text-xs opacity-75",children:y(e.timestamp)})]})},s))})]}),g&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[t.jsx(c,{className:"h-5 w-5 mr-2"}),"MFA Usage (Last 30 Days)"]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g.totalAttempts}),t.jsx("div",{className:"text-sm text-gray-600",children:"Total Attempts"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:g.successfulAttempts}),t.jsx("div",{className:"text-sm text-gray-600",children:"Successful"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:g.failedAttempts}),t.jsx("div",{className:"text-sm text-gray-600",children:"Failed"})]})]}),g.totalAttempts>0&&t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Success Rate"}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:g.successfulAttempts/g.totalAttempts*100+"%"}})}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Math.round(g.successfulAttempts/g.totalAttempts*100),"% success rate"]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[t.jsx(i,{className:"h-5 w-5 mr-2"}),"Method Usage"]}),Object.keys(g.methodUsage).length>0?t.jsx("div",{className:"space-y-3",children:Object.entries(g.methodUsage).sort(([,e],[,s])=>s-e).map(([e,s])=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:e}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:s/Math.max(...Object.values(g.methodUsage))*100+"%"}})}),t.jsx("span",{className:"text-sm text-gray-600 w-8 text-right",children:s})]})]},e))}):t.jsx("p",{className:"text-sm text-gray-500",children:"No MFA usage data available"})]})]}),m?.recentActivity&&m.recentActivity.length>0&&t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[t.jsx(d,{className:"h-5 w-5 mr-2"}),"Recent MFA Activity"]}),t.jsx("div",{className:"space-y-2",children:m.recentActivity.slice(0,5).map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-2 h-2 rounded-full "+(e.success?"bg-green-500":"bg-red-500")}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.action.replace("_"," ").toUpperCase()}),t.jsxs("span",{className:"text-sm text-gray-500",children:["via ",e.method_type]})]}),t.jsx("span",{className:"text-xs text-gray-400",children:y(e.created_at)})]},s))})]})]})};export{m as default};
